(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{0:function(e,t){},1:function(e,t){},10:function(e,t){},11:function(e,t){},12:function(e,t){},13:function(e,t){},14:function(e,t){},15:function(e,t){},16:function(e,t){},2:function(e,t){},"2Qx2":function(e,t,o){"use strict";(function(e,n){o.d(t,"a",(function(){return l}));var i=o("W2Rx"),s=o("oj90");const r=o("33yf"),a=o("Iab2"),l={editingPath:e.observable(null),editingName:e.observable("NewFile"),editingType:e.observable("json"),editingFolder:e.observable(null),isDocumentDirty:e.observable(!1),lastStorageHost:e.observable("LOCAL"),editingFileFolder:function(e=""){const t=l.editingPath()?l.editingPath():"";return e.length>0?r.join(r.dirname(t),e):r.dirname(t)},setNewFile:function(){Swal.fire({title:"📔 Start a New file?",text:`Any unsaved ${l.editingName()} progress will be lost!`,icon:"warning",showCancelButton:!0,confirmButtonText:"New file",cancelButtonText:"No, cancel!",reverseButtons:!0}).then(e=>{e.value&&(l.editingPath(null),l.editingName("NewFile"),l.editingType("json"),l.editingFolder(null),app.workspace.selectedNodes=[],app.editing(null),app.nodes([app.newNode(!0).title("Start")]),app.tags([]),app.updateNodeLinks(),app.workspace.warpToNodeByIdx(0),l.lastStorageHost("LOCAL"),l.isDocumentDirty(!0),app.refreshWindowTitle())})},saveAppStateToLocalStorage:function(){const e=app.settings.storage;l.isDocumentDirty(!0),app.refreshWindowTitle(),e.setItem("appState",JSON.stringify({editingPath:l.editingPath(),editingName:l.editingName(),editingType:l.editingType(),editingFolder:l.editingFolder(),editingTitle:app.editing()?app.editing().title():null,nodes:l.getNodesAsObjects(),tags:app.tags(),editorSelection:app.editor?app.editor.selection.getRange():null,transform:app.workspace.transform,scale:app.workspace.scale,lastStorageHost:l.lastStorageHost()}))},loadAppStateFromLocalStorage:function(){const e=app.settings.storage,t=JSON.parse(e.getItem("appState"));if(t){const{editingPath:e,lastStorageHost:o,editingName:n,editingType:i,editingFolder:s,editingTitle:r,editorSelection:a,nodes:c,tags:d,transform:u,scale:p}=t;l.editingPath(e),l.editingName(n),l.editingType(i),l.editingFolder(s),l.lastStorageHost(o),app.nodes([]),l.getNodesFromObjects(c).forEach(e=>app.nodes.push(e)),app.tags(d),app.updateNodeLinks(),app.workspace.setTranslation(u.x,u.y),app.workspace.setZoom(4*p),r&&(app.editNode(app.nodes().find(e=>e.title()===r)),a&&app.editor.selection.setRange(a)),l.isDocumentDirty(!0),app.refreshWindowTitle()}},readFile:function(e,t,o){var n=new FileReader;n.onload=function(i){var r=l.getFileType(t);r==s.FILETYPE.UNKNOWN?alert("Unknown filetype!"):(l.editingPath(e.path),l.editingType(r),l.loadData(n.result,r,o))},n.readAsText(e)},openFile:function(e,t){l.editingPath()&&!confirm("Are you sure you want to close \n"+l.editingPath()+"\nAny unsaved progress will be lost...")||(l.editingName(t.replace(/^.*[\\\/]/,"")),l.readFile(e,t,!0),l.isDocumentDirty(!1),l.editingPath(e.path),l.lastStorageHost("LOCAL"),app.refreshWindowTitle())},openFiles:function(e,t){const o=document.getElementById("open-file").files;Object.entries(o).forEach(([e,t])=>{"0"===e?l.openFile(t,t.name):l.appendFile(t,t.name)})},openFolder:function(e,t){editingFolder=t,alert("openFolder not yet implemented e: "+e+" foldername: "+t)},appendFile:function(e,t){l.readFile(e,t,!1)},getFileType:function(e){const t=e.toLowerCase();return t.endsWith(".json")?s.FILETYPE.JSON:t.endsWith(".yarn.txt")||t.endsWith(".yarn")?s.FILETYPE.YARN:t.endsWith(".xml")?s.FILETYPE.XML:t.endsWith(".txt")?s.FILETYPE.TWEE:t.endsWith(".tw2")||t.endsWith(".twee")?s.FILETYPE.TWEE2:s.FILETYPE.UNKNOWN},loadData:function(e,t,o){const n=[];if(t==s.FILETYPE.JSON){if(!(e=JSON.parse(e)))return;for(let t=0;t<e.length;t++)n.push(e[t])}else if(t==s.FILETYPE.YARN){var i=e.split(/\r?\n/),r=null,a=0,c=!1;for(let e=0;e<i.length;e++)if("==="===i[e].trim())c=!1,null!=r&&(n.push(r),r=null);else if(c)r.body+=i[e]+"\n";else if(i[e].indexOf("title:")>-1)null==r&&(r={}),r.title=i[e].substr(7,i[e].length-7);else if(i[e].indexOf("position:")>-1){null==r&&(r={});var d=i[e].substr(9,i[e].length-9).split(",");r.position={x:Number(d[0].trim()),y:Number(d[1].trim())}}else i[e].indexOf("colorID:")>-1?(null==r&&(r={}),r.colorID=Number(i[e].substr(9,i[e].length-9).trim())):i[e].indexOf("tags:")>-1?(null==r&&(r={}),r.tags=i[e].substr(6,i[e].length-6)):"---"==i[e].trim()&&(c=!0,r.body="");null!=r&&n.push(r)}else if(t==s.FILETYPE.TWEE||t==s.FILETYPE.TWEE2){i=e.split("\n"),r=null,a=0;for(var u=0;u<i.length;u++)if(i[u]=i[u].trim(),"::"==i[u].substr(0,2)){null!=r&&n.push(r),r={};var p="",g="",h={x:80*++a,y:80*a},f=i[u].indexOf("["),m=i[u].indexOf("]");f>0&&m>0&&(g=i[u].substr(f+1,m-f-1));var y=i[u].indexOf("<"),w=i[u].indexOf(">");if(y>0&&w>0){var b=i[u].substr(y+1,w-y-1).split(",");h.x=parseInt(b[0]),h.y=parseInt(b[1])}var v=0;f>0?v=f:y>0&&(v=y),p=(p=v?i[u].substr(3,v-3):i[u].substr(3)).trim(),r.title=p,r.tags=g,r.body="",r.position=h}else null!=r&&(r.body.length>0&&(i[u]+="\n"),r.body+=i[u]);null!=r&&n.push(r)}else if(t==s.FILETYPE.XML){var x=(new DOMParser).parseFromString(e,"text/xml");if(null!=(e=s.Utils.xmlToObject(x)))for(let t=0;t<e.length;t++)n.push(e[t])}app.limitNodesUpdate(()=>{o&&app.nodes.removeAll(),l.getNodesFromObjects(n).forEach(e=>app.nodes.push(e))}),app.updateNodeLinks(),app.workspace.warpToNodeByIdx(0);var T=new CustomEvent("yarnLoadedData");T.document=document,T.data=l,T.app=app,window.parent.dispatchEvent(T)},getNodeFromObject:function(e){return new i.a({title:e.title,body:e.body,tags:e.tags,colorID:e.colorID,x:parseInt(e.position.x),y:parseInt(e.position.y)})},getNodeAsObject:function(e){return{title:e.title(),tags:e.tags(),body:e.body(),position:{x:e.x(),y:e.y()},colorID:e.colorID()}},getNodesFromObjects:function(e){const t=[];return e?(e.forEach(e=>{t.push(l.getNodeFromObject(e))}),t):[]},getNodesAsObjects:function(){const e=[],t=app.nodes();for(var o=0;o<t.length;o++)e.push(l.getNodeAsObject(t[o]));return e},getSaveData:function(e){var t="",o=l.getNodesAsObjects();if(e==s.FILETYPE.JSON)t=JSON.stringify(o,null,"\t");else if(e==s.FILETYPE.YARN)for(let e=0;e<o.length;e++){t+="title: "+o[e].title+"\n",t+="tags: "+o[e].tags+"\n",t+="colorID: "+o[e].colorID+"\n",t+="position: "+o[e].position.x+","+o[e].position.y+"\n",t+="---\n",t+=o[e].body;var n=o[e].body;n.length>0&&"\n"==n[n.length-1]||(t+="\n"),t+="===\n"}else if(e==s.FILETYPE.TWEE)for(let e=0;e<o.length;e++){var i="";o[e].tags.length>0&&(i=" ["+o[e].tags+"]"),t+=":: "+o[e].title+i+"\n",t+=o[e].body+"\n\n"}else if(e==s.FILETYPE.TWEE2)for(let e=0;e<o.length;e++){i="";o[e].tags.length>0&&(i=" ["+o[e].tags+"]");var r=" <"+o[e].position.x+","+o[e].position.y+">";t+=":: "+o[e].title+i+r+"\n",t+=o[e].body+"\n\n"}else if(e==s.FILETYPE.XML){t+="<nodes>\n";for(let e=0;e<o.length;e++)t+="\t<node>\n",t+="\t\t<title>"+o[e].title+"</title>\n",t+="\t\t<tags>"+o[e].tags+"</tags>\n",t+="\t\t<body>"+o[e].body+"</body>\n",t+='\t\t<position x="'+o[e].position.x+'" y="'+o[e].position.y+'"></position>\n',t+="\t\t<colorID>"+o[e].colorID+"</colorID>\n",t+="\t</node>\n";t+="</nodes>\n"}return l.isDocumentDirty(!1),app.refreshWindowTitle(),t},saveTo:function(e,t,o=null){null!=app.fs&&app.fs.writeFile(e,t,{encoding:"utf-8"},(function(t){l.editingPath(e),o&&o(),t&&alert("Error Saving Data to "+e+": "+t)}))},openFileDialog:function(e,t){e.bind("change",(function(o){t(o.currentTarget.files[0],e.val());var n="";null!=e.attr("nwsaveas")&&(n='nwsaveas="'+e.attr("nwsaveas")+'"'),null!=e.attr("accept")&&(n='accept="'+e.attr("accept")+'"'),e.parent().append('<input type="file" id="'+e.attr("id")+'"  '+n+">"),e.unbind("change"),e.remove()})),e.trigger("click")},saveFileDialog:function(e,t,o){var n=new Blob([o],{type:"text/plain;charset=utf-8"});a(n,(l.editingName()||"").replace(/\.[^/.]+$/,"")+"."+t)},insertImageFileName:function(){l.openFileDialog(n("#open-image"),(function(e,t){app.insertTextAtCursor(e.path?e.path:e.name)}))},tryOpenFile:function(){l.openFileDialog(n("#open-file"),l.openFiles)},promptFileNameAndFormat:function(e,t=null){Swal.fire({title:"💾 Save file - enter file name",html:`<input id="swal-input1" list="select-file-name" name="select" placeholder="${l.editingName()}">\n      <datalist class="form-control" id="select-file-name">    \n        ${t&&t.map(e=>`<option value="${e}" />`).join("")}\n      </datalist>`,onOpen:()=>{"NewFile"!==l.editingName()&&(document.getElementById("swal-input1").value=l.editingName())},showCancelButton:!0,preConfirm:()=>document.getElementById("swal-input1").value}).then(({value:t})=>{if(t&&""!==t){l.editingName(t);const o=l.editingType(),n=(l.editingName()||"").replace(/\.[^/.]+$/,"")+"."+o,i=l.getSaveData(o);e({editingName:n,yarnData:i})}})},tryShareFilePwa:function(e){l.promptFileNameAndFormat(({editingName:e,yarnData:t})=>{const o=[new Blob([t],{type:"text/plain"})],n=new File(o,e,{});navigator.canShare&&navigator.canShare({files:[n]})?navigator.share({title:e,text:t,file:[n]}).then(()=>console.log("Successful share")).catch(e=>console.log("Error sharing",e)):alert("Web Share API is not supported in your browser.\nTry using it on your smartphone or tablet...")})},trySaveGist:function(e){e&&e.file&&e.file.length>0?e.get(e.file).then(t=>{const o=Object.keys(t.body.files);console.log(o),l.promptFileNameAndFormat(({editingName:t,yarnData:o})=>{e.edit(e.file,{files:{[t]:{content:o}}}),Swal.fire("Saved!","The Yarn has been saved to gitst "+e.file,"success"),l.lastStorageHost("GIST"),l.isDocumentDirty(!1),app.refreshWindowTitle()},o)}):(Swal.fire("Not configured","Your github settings are not configured","warning"),app.ui.openSettingsDialog())},tryOpenGist:function(e){e&&e.file&&e.file.length>0?e.get(e.file).then(e=>{const t=e.body.files,o={};Object.keys(t).forEach(e=>{o[e]=e}),Swal.fire({title:"🐙 Open file from a gist",input:"select",inputOptions:o,inputAttributes:{autocomplete:"off"},inputPlaceholder:"Select a file from the gist",showCancelButton:!0}).then(({value:e})=>{if(e){const o=t[e].content,n=l.getFileType(e);l.loadData(o,n,!0),l.isDocumentDirty(!1),l.lastStorageHost("GIST"),l.editingPath(null),l.editingName(e),app.refreshWindowTitle()}})}):(Swal.fire("Not configured","Your github settings are not configured","warning"),app.ui.openSettingsDialog())},tryOpenFolder:function(){l.openFileDialog(n("#open-folder"),l.openFolder)},tryAppend:function(){l.openFileDialog(n("#open-file"),l.appendFile)},save:function(){app.editingVisualStudioCodeFile()||(l.editingPath()?l.trySaveCurrent():l.trySave(s.FILETYPE.JSON))},trySave:function(e){l.editingType(e),l.saveFileDialog(n("#save-file"),e,l.getSaveData(e))},trySaveCurrent:function(){if("GIST"===l.lastStorageHost()){const e=app.gists;e.get(e.file).then(t=>{const o=l.getSaveData(l.editingType());console.log(l.editingName()),e.edit(e.file,{files:{[l.editingName()]:{content:o}}}),l.lastStorageHost("GIST"),l.isDocumentDirty(!1),app.refreshWindowTitle()})}else l.editingPath().length>0&&l.editingType().length>0&&l.saveTo(l.editingPath(),l.getSaveData(l.editingType()))},doesFileExist:function(e){return!1},triggerPasteClipboard:function(){if(app.electron){const e=app.electron.clipboard.readText();app.clipboard=e,document.execCommand("paste")}else navigator.clipboard&&navigator.clipboard.readText().then(e=>{app.clipboard=e}).catch(e=>{app.clipboard=app.editor.getSelectedText(),console.log("No clipboard access",e,"using local instead")}),setTimeout(()=>app.insertTextAtCursor(app.clipboard),100)},triggerCopyClipboard:function(){if(app.electron)app.electron.clipboard.writeText(app.editor.getSelectedText()),app.clipboard=app.editor.getSelectedText();else{const e=app.editor.getSelectedText();app.clipboard=e,navigator.clipboard&&e.length>0&&navigator.clipboard.writeText(e).then(()=>{app.clipboard=e})}}}}).call(this,o("Z1dp"),o("EVdn"))},3:function(e,t){},4:function(e,t){},5:function(e,t){},"5dEm":function(e,t,o){"use strict";(function(e){o.d(t,"a",(function(){return i}));var n=o("oj90");const i=function(t){const o=this;this.canvas=e(".arrows")[0],this.context=o.canvas.getContext("2d"),this.updateArrowsThrottle=50,this.updateArrowsInterval=void 0,this.deferredArrowsDrawInterval=void 0,this.nextArrowsUpdate=Number.NEGATIVE_INFINITY,this.isDrawingArrows=!1,this.selectedNodes=[],this.scale=1,this.offset={x:0,y:0},this.transform={x:0,y:0},this.isMarqueeEnabled=!1,this.marqueeSelection=[],this.marqueeRect={x1:0,y1:0,x2:0,y2:0},this.marqueeOffset=[0,0],this.zoomSpeed=.005,this.zoomLimitMin=.05,this.zoomLimitMax=1,this.setThrottle=function(e,t){const i=t?t.target.value:e;o.updateArrowsThrottle=n.Utils.clamp(i,16,250)},this.setTranslation=function(e,t,n=0){o.transform.x=e,o.transform.y=t,o.translate(n)},this.shiftTranslation=function(e,t,n=0){o.setTranslation(o.transform.x+e,o.transform.y+t,n)},this.translate=function(t){t&&o.startUpdatingArrows(),e(".nodes-holder").finish().transition({transform:"matrix("+o.scale+",0,0,"+o.scale+","+o.transform.x+","+o.transform.y+")"},t||0,"easeInQuad",(function(){t&&o.stopUpdatingArrows(),o.updateArrows()}))},this.toWorkspaceCoordinates=(e,n)=>({x:(e-t.workspace.transform.x)/o.scale,y:(n-t.workspace.transform.y)/o.scale}),this.onPanLeft=function(){o.shiftTranslation(o.getPanAmount(),0,100)},this.onPanRight=function(){o.shiftTranslation(-o.getPanAmount(),0,100)},this.onPanUp=function(){o.shiftTranslation(0,o.getPanAmount(),100)},this.onPanDown=function(){o.shiftTranslation(0,-o.getPanAmount(),100)},this.getPanAmount=function(){return t.input.isShiftDown?100*o.scale:500*o.scale},this.setZoom=function(e){o.scale=e/4,o.translate(200)},this.onZoom=function(e,t,i){const s=o.scale,r=i*o.zoomSpeed*o.scale;o.scale=n.Utils.clamp(o.scale+r,o.zoomLimitMin,o.zoomLimitMax);const a=e-o.transform.x,l=t-o.transform.y,c=a-a*(o.scale/s),d=l-l*(o.scale/s);o.shiftTranslation(c,d)},this.onDragStart=function(e){o.offset.x=e.x,o.offset.y=e.y},this.onDragUpdate=function(e){o.isMarqueeEnabled&&t.workspace.onMarqueeEnd(),t.workspace.shiftNodes(e)},this.onDragEnd=function(){t.data.saveAppStateToLocalStorage()},this.onMarqueeStart=function(e){o.isMarqueeEnabled=!0,o.offset.x=e.x,o.offset.y=e.y,o.marqueeSelection=[],o.marqueeOffset[0]=0,o.marqueeOffset[1]=0,o.marqueeRect={x1:0,y1:0,x2:0,y2:0}},this.onMarqueeUpdate=function(e){o.isMarqueeEnabled&&(o.updateMarqueeRect(e),o.selectNodesInsideMarquee())},this.updateMarqueeRect=function(t){t.x>o.offset.x&&t.y<o.offset.y?(o.marqueeRect.x1=o.offset.x,o.marqueeRect.y1=t.y,o.marqueeRect.x2=t.x,o.marqueeRect.y2=o.offset.y):t.x>o.offset.x&&t.y>o.offset.y?(o.marqueeRect.x1=o.offset.x,o.marqueeRect.y1=o.offset.y,o.marqueeRect.x2=t.x,o.marqueeRect.y2=t.y):t.x<o.offset.x&&t.y<o.offset.y?(o.marqueeRect.x1=t.x,o.marqueeRect.y1=t.y,o.marqueeRect.x2=o.offset.x,o.marqueeRect.y2=o.offset.y):(o.marqueeRect.x1=t.x,o.marqueeRect.y1=o.offset.y,o.marqueeRect.x2=o.offset.x,o.marqueeRect.y2=t.y),e("#marquee").css({display:"block",x:o.marqueeRect.x1,y:o.marqueeRect.y1,width:Math.abs(o.marqueeRect.x1-o.marqueeRect.x2),height:Math.abs(o.marqueeRect.y1-o.marqueeRect.y2)})},this.selectNodesInsideMarquee=function(){const e=o.toWorkspaceCoordinates(o.marqueeRect.x1,o.marqueeRect.y1),i=o.toWorkspaceCoordinates(o.marqueeRect.x2,o.marqueeRect.y2),s={left:e.x,right:i.x,top:e.y,bottom:i.y};t.nodes().forEach(e=>{const t=o.marqueeSelection.indexOf(e),i=t>=0,r=e.x(),a=e.y(),l={left:r,right:r+e.width,top:a,bottom:a+e.height},c=n.Utils.rectanglesOverlap(s,l);c&&!i&&(o.selectNodes(e),o.marqueeSelection.push(e)),!c&&i&&(o.deselectNodes(e),o.marqueeSelection.splice(t,1))})},this.onMarqueeEnd=function(){o.isMarqueeEnabled&&(0==o.marqueeSelection.length&&o.deselectAll(),o.isMarqueeEnabled=!1,o.marqueeSelection=[],o.marqueeRect={x1:0,y1:0,x2:0,y2:0},e("#marquee").css({display:"none",x:0,y:0,width:0,height:0}))},this.shiftNodes=function(e){const t={x:e.x-o.offset.x,y:e.y-o.offset.y};o.shiftTranslation(t.x,t.y),o.offset=e},this.startUpdatingArrows=function(){o.stopUpdatingArrows(),o.updateArrowsInterval=setInterval(o.updateArrows,o.updateArrowsThrottle)},this.stopUpdatingArrows=function(){o.updateArrowsInterval&&(window.clearInterval(o.updateArrowsInterval),o.updateArrowsInterval=void 0)},this.updateArrows=function(){if(o.isDrawingArrows)return;const n=(new Date).getTime();if(n<o.nextArrowsUpdate)return void(o.deferredArrowsDrawInterval||(o.deferredArrowsDrawInterval=window.setTimeout(o.updateArrows,o.nextArrowsUpdate+o.updateArrowsThrottle-n)));o.isDrawingArrows=!0,window.clearInterval(o.deferredArrowsDrawInterval),o.deferredArrowsDrawInterval=void 0,o.nextArrowsUpdate=n+o.updateArrowsThrottle;const i=t.nodes(),s=e(".nodes-holder").offset(),r=o.scale,a=3*r,l=8*r,c=6*r,d=[],u=[];o.canvas.width=e(window).width(),o.canvas.height=e(window).height(),o.context.lineWidth=a,o.context.strokeStyle=o.context.fillStyle="rgba(0, 0, 0, 1)";for(let t of i)if(t.halfWidth=e(t.element).width()/2,t.halfHeight=e(t.element).height()/2,t.linkedTo().length){const e=(t.x()+t.halfWidth)*r+s.left,o=(t.y()+t.halfHeight)*r+s.top;for(let n of t.linkedTo()){const t=(n.x()+n.halfWidth)*r+s.left,i=(n.y()+n.halfHeight)*r+s.top,a=Math.sqrt((e-t)*(e-t)+(o-i)*(o-i)),p={x:(t-e)/a,y:(i-o)/a},g=(110+160*(1-Math.max(Math.abs(p.x),Math.abs(p.y))))*r,h={x:e+p.x*g,y:o+p.y*g},f={x:t-p.x*g,y:i-p.y*g};d.push({x1:h.x,y1:h.y,x2:f.x,y2:f.y}),u.push({x1:f.x+10*p.x,y1:f.y+10*p.y,x2:f.x-p.x*l-p.y*c,y2:f.y-p.y*l+p.x*c,x3:f.x-p.x*l+p.y*c,y3:f.y-p.y*l-p.x*c})}}o.context.beginPath();for(let e of d)o.context.moveTo(e.x1,e.y1),o.context.lineTo(e.x2,e.y2);o.context.stroke(),o.context.beginPath();for(let e of u)o.context.moveTo(e.x1,e.y1),o.context.lineTo(e.x2,e.y2),o.context.lineTo(e.x3,e.y3);o.context.fill(),o.isDrawingArrows=!1},this.bringToFront=function(t){const o=e(t),i=n.Utils.getHighestZ(o.parent());o.css("z-index",i+1)},this.selectAll=function(){o.selectNodes(t.nodes())},this.deselectAll=function(){o.deselectNodes(t.nodes())},this.selectNodes=function(e){const t=Array.isArray(e)?e:[e];for(let e of t)o.selectedNodes.includes(e)||(o.selectedNodes.push(e),e.setSelected(!0))},this.deselectNodes=function(e){const t=Array.isArray(e)?e:[e];for(let e of t){const t=o.selectedNodes.indexOf(e);t>=0&&(o.selectedNodes.splice(t,1),e.setSelected(!1))}},this.getSelectedNodes=function(){return 1===o.selectedNodes.length?[o.selectedNodes[0]]:Array.apply(this,o.selectedNodes)},this.warpToNodeByIdx=function(e){o.warpToNode(t.nodes()[e]),t.focusedNodeIdx=e},this.warpToSelectedNodeByIdx=function(e){o.warpToNode(o.getSelectedNodes()[e]),t.focusedNodeIdx=e},this.warpToNode=function(e){e&&o.warpToXY(e.x()||e.createX,e.y()||e.createY)},this.warpToXY=function(t,n){const i=-t*o.scale,s=-n*o.scale,r=e(window).width()/2,a=e(window).height()/2,l=100*o.scale/2,c=100*o.scale/2;o.setTranslation(i+r-l,s+a-c,100)},this.alignY=function(){const e=t.nodes().filter(e=>e.selected).sort((e,t)=>e.y()>t.y()?1:e.y()<t.y()?-1:0),o=e.shift();e.length?e.forEach((e,t)=>{const n=o.y()+210*(t+1);e.moveTo(o.x(),n)}):alert("Select nodes to align")},this.alignX=function(){const e=t.nodes().filter(e=>e.selected).sort((e,t)=>e.x()>t.x()?1:e.x()<t.x()?-1:0),o=e.shift();e.length?e.forEach((e,t)=>{const n=o.x()+210*(t+1);e.moveTo(n,o.y())}):alert("Select nodes to align")},this.arrangeSpiral=function(){o.getSelectedNodes().forEach((e,t)=>{e.moveTo(Math.cos(.5*t)*(600+30*t),Math.sin(.5*t)*(600+30*t))})},this.sortAlphabetical=function(){const t=o.getSelectedNodes().sort((e,t)=>e.title().localeCompare(t.title()));if(!t.length)return;let n=Math.round(t.length/2),i=0,s=0;const r=e(t[0].element).width()+30,a=e(t[0].element).height()+30;t.forEach((e,o)=>{o%n?i+=1:(s+=1,i=0),1===o&&(s=0),e.moveTo(t[0].x()+i*r,t[0].y()+s*a)}),o.warpToNode(t[0])}}}).call(this,o("EVdn"))},6:function(e,t){},7:function(e,t){},8:function(e,t){},9:function(e,t){},INAQ:function(e,t,o){"use strict";(function(e,n){o.d(t,"a",(function(){return s}));var i=o("oj90");const s=function(t){const o=this,s=Object.freeze({Left:0,Middle:1,Right:2}),r=Object.freeze({Enter:13,Escape:27,Space:32,Left:37,Up:38,Right:39,Down:40,Delete:46,A:65,C:67,D:68,O:79,S:83,V:86,W:87,X:88,Y:89,Z:90});this.mouse={x:0,y:0},this.isDragging=!1,this.isScreenTouched=!1,this.isMiddleButtonDown=!1,this.isLeftButtonDown=!1,this.isShiftDown=!1,this.trackMouseEvents=function(){e(document).on("pointerdown",e=>{if(o.isDragging="nodes"===e.target.className,o.mouse.x=e.pageX,o.mouse.y=e.pageY,o.isMiddleButtonDown=e.button===s.Middle,this.isLeftButtonDown=e.button===s.Left,t.inWorkspace()){if(o.isDragging)switch(e.button){case s.Left:t.workspace.onMarqueeStart({x:e.pageX,y:e.pageY});break;case s.Middle:t.workspace.onDragStart({x:e.pageX,y:e.pageY})}}else t.inEditor()&&e.button===s.Right&&(t.guessPopUpHelper(),e.preventDefault())}),window.addEventListener("touchstart",()=>{o.isScreenTouched=!0}),e(document).on("pointermove",e=>{o.mouse.x=e.pageX,o.mouse.y=e.pageY}),e(document).on("mousemove touchmove",e=>{if(o.isDragging){t.focusedNodeIdx=-1;const n=o.isScreenTouched&&e.changedTouches?e.changedTouches[0].pageX:e.pageX,i=o.isScreenTouched&&e.changedTouches?e.changedTouches[0].pageY:e.pageY;t.inWorkspace()&&(e.altKey||o.isMiddleButtonDown||o.isScreenTouched?t.workspace.onDragUpdate({x:n,y:i}):t.workspace.onMarqueeUpdate({x:n,y:i}))}}),e(document).on("pointerup touchend",e=>{o.isScreenTouched=!1,o.isDragging=!1,e.button===s.Left&&(o.isLeftButtonDown=!1),e.button===s.Middle&&(o.isMiddleButtonDown=!1),t.inWorkspace()&&(t.workspace.onDragEnd(),t.workspace.onMarqueeEnd())}),e(".nodes").mousewheel(e=>{e.altKey||t.inWorkspace()&&(t.workspace.onZoom(e.pageX,e.pageY,e.deltaY),e.preventDefault())}),e(document).contextmenu(o=>{if(!t.inWorkspace())return;const n=e(o.target).hasClass("nodes")||e(o.target).parents(".nodes").length;if(o.button===s.Right&&n){const{x:e,y:n}=t.workspace.toWorkspaceCoordinates(o.pageX,o.pageY);t.newNodeAt(e,n)}return!n})},this.trackKeyboardEvents=function(){e(document).on("keyup keydown",e=>{o.isShiftDown=e.shiftKey}),e(document).on("keyup",(function(e){if(e.keyCode===r.Space){if(t.inWorkspace()&&e.altKey||t.inEditor()&&!e.altKey)return;t.workspace.scale=1;const o=t.workspace.getSelectedNodes(),n=o.length>0,i=n>0?o:t.nodes();++t.focusedNodeIdx,(t.focusedNodeIdx<0||t.focusedNodeIdx>=i.length)&&(t.focusedNodeIdx=0),t.inWorkspace()?n?t.workspace.warpToSelectedNodeByIdx(t.focusedNodeIdx):t.workspace.warpToNodeByIdx(t.focusedNodeIdx):t.inEditor()&&t.editNode(t.nodes()[t.focusedNodeIdx])}else e.keyCode===r.Z&&(t.previewStory.changeTextScrollSpeed(200),-1!=t.previewStory.vnSelectedChoice&&t.previewStory.vnSelectChoice())})),e(document).on("keydown",e=>{if(t.inWorkspace()){if((e.metaKey||e.ctrlKey)&&e.shiftKey)switch(e.keyCode){case r.S:t.data.trySave(i.FILETYPE.JSON);break;case r.A:t.data.tryAppend()}if((e.metaKey||e.ctrlKey)&&e.altKey)switch(e.keyCode){case r.S:t.data.trySave(i.FILETYPE.YARN)}else if(e.metaKey||e.ctrlKey)switch(e.keyCode){case r.C:t.nodeClipboard=t.cloneNodeArray(t.workspace.getSelectedNodes());break;case r.D:t.workspace.deselectAll();break;case r.O:t.data.tryOpenFile();break;case r.S:t.data.trySaveCurrent();break;case r.X:const e=t.workspace.getSelectedNodes();t.nodeClipboard=t.cloneNodeArray(e),t.deleteNodes(e);break;case r.Y:t.historyDirection("redo");break;case r.Z:t.historyDirection("undo")}else e.keyCode===r.Delete||"Delete"===e.key?t.confirmDeleteNodes(t.workspace.getSelectedNodes()):t.$searchField.is(":focus")||e.ctrlKey||e.metaKey||(e.keyCode===r.A||e.keyCode===r.Left?t.workspace.onPanLeft():e.keyCode===r.D||e.keyCode===r.Right?t.workspace.onPanRight():e.keyCode===r.W||e.keyCode===r.Up?t.workspace.onPanUp():e.keyCode!==r.S&&e.keyCode!==r.Down||t.workspace.onPanDown())}}),e(document).on("keyup",e=>{if(t.inWorkspace())if(e.metaKey||e.ctrlKey)switch(e.keyCode){case r.A:t.workspace.selectAll();break;case r.V:t.pasteNodes()}else if(e.keyCode===r.Enter||"Enter"===e.key){const e=t.nodes()[t.focusedNodeIdx];e?t.editNode(e):t.editNode(t.nodes()[0])}}),e(document).on("keydown",(function(e){if(t.inEditor())if(e.metaKey||e.ctrlKey)switch(e.keyCode){case r.C:o.clipboard=t.editor.getSelectedText();break;case r.X:document.execCommand("copy"),t.clipboard=t.editor.getSelectedText(),t.insertTextAtCursor("")}else switch(e.keyCode){case r.Escape:t.saveNode()}})),e(document).on("keyup",(function(e){if(t.inEditor()&&(e.metaKey||e.ctrlKey)&&e.altKey)switch(e.keyCode){case r.Enter:t.saveNode()}})),e(document).on("keydown",(function(e){if(t.ui.settingsDialogVisible())switch(e.keyCode){case r.Escape:t.ui.closeSettingsDialog()}})),e(document).on("keyup keydown pointerdown pointerup",(function(e){t.inEditor()&&t.updateEditorStats()})),e(document).on("keydown",e=>{if(t.editing()&&!t.previewStory.finished)switch(e.keyCode){case r.Z:t.previewStory.changeTextScrollSpeed(10),-1!=t.previewStory.vnSelectedChoice&&t.previewStory.vnSelectChoice();break;case r.Up:-1!=t.previewStory.vnSelectedChoice&&t.previewStory.vnUpdateChoice(-1);break;case r.Down:-1!=t.previewStory.vnSelectedChoice&&t.previewStory.vnUpdateChoice(1)}})},this.initKnockoutBindings=function(){n.bindingHandlers.preventBubble={init:function(e,t){var o=n.utils.unwrapObservable(t());n.utils.registerEventHandler(e,o,(function(e){e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation()}))}},n.bindingHandlers.mousedown={init:function(t,o,i,s,r){var a=n.unwrap(o());e(t).mousedown((function(){a()}))}}};o.initKnockoutBindings(),o.trackMouseEvents(),o.trackKeyboardEvents()}}).call(this,o("EVdn"),o("Z1dp"))},P0sH:function(e,t,o){"use strict";(function(e,n){o.d(t,"a",(function(){return h}));var i=o("owJe"),s=o("W2Rx"),r=o("5dEm"),a=o("INAQ"),l=o("pYPP"),c=o("fkuv"),d=o("2Qx2"),u=o("P3rc"),p=o("oj90"),g=o("l8+o"),h=function(t,h){const f=this;this.setTheme=function(e,t){let o=t?t.target.value:e;document.getElementById("theme-stylesheet").href=p.Utils.getPublicPath(`themes/${o}.css`)},this.setLanguage=function(e,t){const o=t?t.target.value:e;spoken.recognition.lang=o,Object(i.load_dictionary)(f.settings.language().split("-")[0])},this.setMarkupLanguage=function(e,t){t&&t.target.value;f.richTextFormatter=new g.a(f),f.mustRefreshNodes.notifySubscribers()},this.setPlaytestStyle=function(e,t){const o=t?t.target.value:e;f.playtestStyle=o},this.setGistCredentials=function(e,t){const{token:n,file:i}=e,s=new(o("XZLo"))({token:n});f.gists=s,f.gists.file=i},this.input=new a.a(f),this.settings=new l.a(f),this.workspace=new r.a(f),this.ui=new c.a(f),this.previewStory=new u.a,this.richTextFormatter=new g.a(f),this.data=d.a,this.name=e.observable(t),this.version=e.observable(h),this.editing=e.observable(null),this.nodes=e.observableArray([]),this.tags=e.observableArray([]),this.mustRefreshNodes=e.observable(),this.mustUpdateTags=!0,this.nodeHistory=[],this.nodeFuture=[],this.editingHistory=[],this.editingSaveHistoryTimeout=null,this.focusedNodeIdx=-1,this.isElectron=!1,this.editor=null,this.nodeVisitHistory=[],this.clipboard="",this.nodeClipboard=[],this.speachInstance=null,this.editingPath=e.observable(null),this.$searchField=n(".search-field"),this.isEditorInPreviewMode=!1,this.inEditor=()=>f.editing()&&!f.ui.isDialogOpen(),this.inWorkspace=()=>!f.editing()&&!f.ui.isDialogOpen(),this.run=function(){var t="Unknown OS";-1!=navigator.platform.indexOf("Win")&&(t="Windows"),-1!=navigator.platform.indexOf("Mac")&&(t="MacOS"),-1!=navigator.platform.indexOf("X11")&&(t="UNIX"),-1!=navigator.platform.indexOf("Linux")&&(t="Linux"),-1!=navigator.platform.indexOf("Linux")&&(t="Linux"),f.isElectron=navigator.userAgent.toLowerCase().includes("electron");var o=navigator.userAgent||navigator.vendor||window.opera;let i;/android|iPad|iPhone|iPod/.test(o.toLowerCase())&&!window.MSStream&&(t="mobile"),"Windows"==t&&(f.workspace.zoomSpeed=.1),window.addEventListener("beforeunload",e=>(this.data.saveAppStateToLocalStorage(),null)),window.addEventListener("DOMContentLoaded",e=>{this.data.loadAppStateFromLocalStorage();const t=new URL(window.location),o=t.searchParams.get("text")||t.searchParams.get("url");null!==o&&f.insertTextAtCursor(o),console.log(f.settings)});const s=n("#addPwa")[0];s.style.display="none",window.addEventListener("beforeinstallprompt",e=>{e.preventDefault(),i=e,s.style.display="block",s.addEventListener("click",e=>{s.style.display="none",i.prompt(),i.userChoice.then(e=>{"accepted"===e.outcome?(console.log("User accepted the A2HS prompt"),s.style.display="none"):console.log("User dismissed the A2HS prompt"),i=null})})}),n("#app").show(),e.applyBindings(f,n("#app")[0]),f.editingVisualStudioCodeFile()||f.newNode().title("Start"),f.settings.apply(),n(".search-title input").click(f.updateSearch),n(".search-body input").click(f.updateSearch),n(".search-tags input").click(f.updateSearch),f.$searchField.on("input",f.updateSearch),f.$searchField.on("keyup",(function(e){27==e.keyCode?f.clearSearch():f.searchWarp()})),"mobile"===t&&f.workspace.setZoom(3),n(window).on("resize",f.workspace.updateArrows),this.guessPopUpHelper=function(){/color=#([a-zA-Z0-9]{3,6})$/.test(f.getTagBeforeCursor())&&f.insertColorCode()},this.insertEmoji=function(){this.emPicker.toggle(),f.togglePreviewMode(!0),n("#emojiPicker-container").css({left:f.input.mouse.x-200,top:f.input.mouse.y-125}),n("#emojiPicker-container").show()},this.insertColorCode=function(){n("#colorPicker-container").is(":visible")||(n("#colorPicker").spectrum("set",f.editor.getSelectedText()),n("#colorPicker").spectrum("toggle"),n("#colorPicker-container").css({left:f.input.mouse.x-70,top:f.input.mouse.y-50}),n("#colorPicker-container").show(),f.togglePreviewMode(!0),setTimeout(()=>{const e=n("#colorPicker").spectrum("get");f.applyPickerColorEditor(e)},100))},this.applyPickerColorEditor=function(e){const t=JSON.parse(JSON.stringify(f.editor.selection.getRange()));f.editor.selection.setRange(t);const o=e.toHexString().replace("#","");f.editor.session.replace(t,o),f.editor.selection.setRange({start:f.editor.getCursorPosition(),end:{row:f.editor.getCursorPosition().row,column:f.editor.getCursorPosition().column-o.length}}),f.togglePreviewMode(!0)},document.addEventListener("contextmenu",(function(e){f.editing()&&e.preventDefault()}),!1),this.speakText=function(){const e=f.editor.getSelectedText(),t=e||f.editor.getSession().getValue();spoken.voices().then(e=>{const o=f.settings.language().split("-")[0],n=e.filter(e=>!e.lang.indexOf(o));n.length?(console.log("Loaded voice",n[0]),spoken.say(t,n[0])):spoken.say(t)})},this.startCapture=function(){spoken.listen({continuous:!0}).then(e=>{if(console.log(e),f.editing())f.insertTextAtCursor(e+". "),document.getElementById("speakTextBtnBubble").title="Transcribe";else if("open"===e){console.log("try open...");var t=f.getFirstFoundNode(f.$searchField.val().toLowerCase()).title();console.log("try open:",t),f.openNodeByTitle(t)}else"clear"===e?(f.$searchField.val(""),f.updateSearch()):(f.$searchField.val(e),f.updateSearch());spoken.listen.stop().then(()=>{f.editing()&&(document.getElementById("speakTextBtnBubble").style.visibility="hidden"),this.continueCapture()})}).catch(e=>spoken.listen.stop().then(()=>this.continueCapture()))},this.continueCapture=function(){spoken.delay(500).then(()=>{spoken.recognition.continuous&&f.startCapture()})},this.toggleTranscribing=function(){const e=spoken.listen.available();var t=document.getElementById("speakTextBtnBubble");e&&f.settings.transcribeEnabled()?(spoken.listen.on.partial(e=>{f.editing()?(t.style.visibility="visible",t.title=`🗣️ ${e} 🦜`):f.$searchField.val(`🗣️ ${e} 🦜`)}),f.startCapture()):(t.style.visibility="hidden",spoken.recognition.continuous=!1,spoken.listen.stop())},this.hearText=function(){spoken.listen.available()?(spoken.listen.on.partial(e=>{console.log(e),document.getElementById("speakTextBtnBubble").title=`🗣️ ${e} 🦜`}),spoken.listen().then(e=>{f.insertTextAtCursor(e+" "),document.getElementById("speakTextBtnBubble").title="Transcribe"}).catch(e=>console.warn(e.message))):alert("Speech recognition not avaiilable!")},document.ondragover=document.ondrop=e=>{e.preventDefault()},document.body.ondrop=e=>{e.preventDefault();for(var t=0;t<e.dataTransfer.files.length;t++)d.a.appendFile(e.dataTransfer.files[t],e.dataTransfer.files[t].name,!1)},window.addEventListener("message",e=>{const t=e.data;switch(t.type){case"UpdateNode":f.nodes().forEach(e=>{e.title().trim()===t.payload.originalNodeTitle.trim()&&(e.title(t.payload.title),e.tags(t.payload.tags),e.body(t.payload.body),f.setYarnDocumentIsDirty())})}});var r=new CustomEvent("yarnReady");r.document=document,r.data=d.a,r.app=this,window.parent.dispatchEvent(r)},this.limitNodesUpdate=function(e){f.nodes.extend({rateLimit:{method:"notifyWhenChangesStop",timeout:250}}),e(),f.nodes.limit(e=>()=>e())},this.getNodesConnectedTo=function(e){var t=[],o=f.nodes();for(var n in o)if(o[n]!=e&&o[n].isConnectedTo(e,!0)){var i=!1;for(var s in t)if(t[s]==o[n]){i=!0;break}i||t.push(o[n])}return t},this.matchConnectedColorID=function(e){var t=f.getNodesConnectedTo(e);for(var o in t)t[o].colorID(e.colorID())},this.quit=function(){f.isElectron},this.validateTitle=function(){var e=document.getElementById("editorTitle").value,t=n("#editorTitle");f.getOtherNodeTitles().includes(e)||f.titleExistsTwice(e)?(t.css({color:"red"}),t.attr("title","Another node has the same title")):RegExp("^[a-z0-9]+$","i").test(e)?(t.css({color:"#666"}),t.removeAttr("title")):(t.css({color:"red"}),t.attr("title","Only upper or lower case letters and numbers are allowed in a node title."))},this.refreshWindowTitle=function(){let e="";"LOCAL"===d.a.lastStorageHost()?e="Yarn - "+(d.a.editingPath()||d.a.editingName())+" "+(d.a.isDocumentDirty()?"*":""):"GIST"===d.a.lastStorageHost()&&(e="Gist - "+(d.a.editingPath()||d.a.editingName())+" "+(d.a.isDocumentDirty()?"*":"")),f.electron?f.electron.remote.getCurrentWindow().setTitle(e):document.title=e},this.usingVisualStudioCodeExtension=function(){return!!window.vsCodeApi},this.editingVisualStudioCodeFile=function(){return!0===window.editingVsCodeFile},this.setYarnDocumentIsDirty=function(){f.usingVisualStudioCodeExtension()&&f.editingVisualStudioCodeFile()&&window.vsCodeApi.postMessage({type:"DocumentEdit",payload:d.a.getSaveData(d.a.editingType())})},this.recordNodeAction=function(e,t){if(f.nodeFuture.length>0){for(var o=0;o<f.nodeFuture.length;o++){delete f.nodeFuture.pop().node}delete f.nodeFuture,f.nodeFuture=[]}var n={action:e,node:t,lastX:t.x(),lastY:t.y()};"removed"==e&&(n.lastY+=80),f.nodeHistory.push(n),f.setYarnDocumentIsDirty()},this.historyDirection=function(e){function t(e){var t=f.nodes.indexOf(e);t>=0&&f.nodes.splice(t,1),f.updateNodeLinks()}var o=null;if(o="undo"==e?f.nodeHistory.pop():f.nodeFuture.pop()){var n=o.action,i=o.node;"undo"==e?("created"==n?(o.lastX=i.x(),o.lastY=i.y(),t(i)):"removed"==n&&f.recreateNode(i,o.lastX,o.lastY),f.nodeFuture.push(o),f.setYarnDocumentIsDirty()):("created"==n?f.recreateNode(i,o.lastX,o.lastY):"removed"==n&&t(i),f.nodeHistory.push(o),f.setYarnDocumentIsDirty())}},this.recreateNode=function(e,t,o){f.nodes.push(e),e.moveTo(t,o),f.updateNodeLinks()},this.setSelectedColors=function(e){var t=f.workspace.getSelectedNodes();for(var o in t.splice(t.indexOf(e),1),t)t[o].colorID(e.colorID())},this.pasteNodes=function(){f.nodeClipboard.length&&(f.workspace.deselectAll(),f.nodeClipboard.forEach((function(e){var t=new s.a({title:f.getUniqueTitle(e.title()),body:e.body(),tags:e.tags(),colorID:e.colorID(),x:e.createX,y:e.createY});f.nodes.push(t),f.workspace.selectNodes(t),f.recordNodeAction("created",t)})),f.updateNodeLinks())},this.confirmDeleteNodes=function(e){const t=Array.isArray(e)?void 0:e,o=Array.isArray(e)?[...e]:t&&t.selected?[...f.workspace.getSelectedNodes()]:[e];o.length&&Swal.fire({title:"Are you sure?",text:`${o.length} ${1===o.length?"node":"nodes"} will be deleted.`,icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete!",cancelButtonText:"No, cancel!",reverseButtons:!0}).then(e=>{e.value&&f.deleteNodes(o)})},this.deleteNodes=function(e){const t=Array.isArray(e)?e:[e],o=[];for(let e=t.length-1;e>=0;--e)o.push(t[e].remove());Promise.all(o).then(()=>{f.limitNodesUpdate(()=>{for(let e=t.length-1;e>=0;--e)f.deleteNode(t[e]);f.updateNodeLinks(),f.workspace.deselectNodes(t),f.workspace.updateArrows()})})},this.deleteNode=function(e){const t=f.nodes.indexOf(e);t>=0&&(f.recordNodeAction("removed",e),f.nodes.splice(t,1)),f.setYarnDocumentIsDirty()},this.cloneNodeArray=function(e){return e.map((function(e){return new s.a({title:e.title(),body:e.body(),tags:e.tags(),colorID:e.colorID(),x:e.x()+10,y:e.y()+10})}))},this.newNode=function(e=!0){var t=new s.a;return f.nodes.push(t),e&&f.updateNodeLinks(),f.recordNodeAction("created",t),t},this.newNodeAt=function(e,t){var o=new s.a({x:e-100,y:t-100});return f.nodes.push(o),f.updateNodeLinks(),f.recordNodeAction("created",o),o},this.searchTextInEditor=function(e=!0){e?f.editor.execCommand("find"):f.editor.searchBox&&f.editor.searchBox.hide()},this.showRandomQuote=function(){n.ajax({url:"https://api.forismatic.com/api/1.0/?",dataType:"jsonp",data:"method=getQuote&format=jsonp&lang=en&jsonp=?",success:function(e){alert(e.quoteText+"\n\n-"+e.quoteAuthor)}})},this.editNode=function(e){if(!e.active())return;if(f.settings.alwaysOpenNodesInVisualStudioCodeEditor())return void f.editNodeInVisualStudioCodeEditor(e);f.editing()&&f.editing()!==e&&f.saveNode(!1),e.oldTitle=e.title(),f.editing(e),f.mustUpdateTags=!0,n(".node-editor").css({opacity:0}).transition({opacity:1},250),n(".node-editor .form").css({y:"-100"}).transition({y:"0"},250),f.editor=ace.edit("editor"),f.editor.navigateFileEnd(),n("#colorPicker").spectrum({flat:!0,showButtons:!1,showInput:!0,showPalette:!0,preferredFormat:"hex",palette:[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"]],move:function(e){f.applyPickerColorEditor(e)},clickoutFiresChange:!0});const t=ace.require("ace/ext/language_tools"),o=p.Utils.createAutocompleter(["string.llink","string.rlink"],f.getOtherNodeTitles(),"Node Link");t.setCompleters([o,t.keyWordCompleter,t.textCompleter,t.snippetCompleter]);let i=void 0;f.editor.getSession().on("change",(function(e){const t=n("#toglAutocomplete").prop("checked");"insert"===e.action&&t&&(i&&clearTimeout(i),i=setTimeout(()=>{i=void 0,f.richTextFormatter.completableTags.forEach(e=>{f.getTagBeforeCursor()===e.Start&&(e.Completion&&f.insertTextAtCursor(e.Completion),e.Offset&&f.moveEditCursor(e.Offset),e.Func&&e.Func())})},200))})),this.emPicker=new EmojiPicker(document.getElementById("emojiPickerDom"),e=>{f.insertTextAtCursor(e.char),this.emPicker.toggle(),f.togglePreviewMode(!1)}),f.toggleTranscribing(),f.toggleNightMode(),f.toggleShowCounter(),f.toggleWordCompletion(),f.toggleSpellCheck(),f.validateTitle(),f.updateEditorStats(),f.$searchField.val().length>0&&n(".search-body input").is(":checked")&&f.editor.findAll(f.$searchField.val())},this.editNodeInVisualStudioCodeEditor=function(e){f.usingVisualStudioCodeExtension()?(f.setYarnDocumentIsDirty(),window.vsCodeApi.postMessage({type:"OpenNode",payload:{title:e.title().trim(),tags:e.tags().trim(),body:f.trimBodyLinks(e.body().trim())}})):console.error("Tried to open node in Visual Studio Code text editor but we're not in the Visual Studio Code extension")},this.chooseRelativePathImage=function(e){f.insertTextAtCursor(e)},this.openNodeByTitle=function(e){f.makeNodeWithName(e),f.nodes().forEach(t=>{t.title().trim().toLowerCase()===e.trim().toLowerCase()&&f.editNode(t)})},this.openLastEditedNode=function(){if(0===f.nodeVisitHistory.length)f.saveNode();else{const e=f.nodeVisitHistory.pop();f.propagateUpdateFromNode(f.editing()),f.openNodeByTitle(e)}},this.getSpellCheckSuggestionItems=function(){var e=Object(i.suggest_word_for_misspelled)(f.editor.getSelectedText());if(e){var t={};return e.forEach(e=>{t[e]={name:e,icon:"edit",callback:e=>{f.insertTextAtCursor(e)}}}),t}return!1},this.getThesaurusItems=function(){var e=o("GLdW")(f.editor.getSelectedText());if(!e)return!1;var t=[];if(Object.keys(e).forEach((function(o){e[o].forEach((function(e){t.includes(e)||e===o||t.push(e)}))})),t.length>0){var n={};return t.forEach(e=>{n[e]={name:e,icon:"edit",callback:e=>{f.insertTextAtCursor(e)}}}),n}return!1},this.toggleSpellCheck=function(){f.settings.spellcheckEnabled()?Object(i.enable_spellcheck)():Object(i.disable_spellcheck)()},this.toggleNightMode=function(){const e=f.settings.nightModeEnabled()?{filter:"invert(100%)"}:{filter:"invert(0%)"};n("#app").css(e),n("#app-bg").css(e),n(".tooltip").css(e),n(".node .body").css(e),n(".node-editor .form .editor-container .editor-preview").css(e)},this.toggleShowCounter=function(){f.settings.editorStatsEnabled()?n(".node-editor .form .bbcode-toolbar .editor-counter").css({display:"initial"}):n(".node-editor .form .bbcode-toolbar .editor-counter").css({display:"none"})},this.toggleWordCompletion=function(){f.updateEditorOptions()},this.toggleClosingCharactersCompletion=function(){f.updateEditorOptions()},this.updateEditorOptions=function(){f.editor.setOptions({enableBasicAutocompletion:app.settings.completeWordsEnabled(),enableLiveAutocompletion:app.settings.completeWordsEnabled(),behavioursEnabled:app.settings.completeClosingCharacters()})},this.advanceStoryPlayMode=function(e=5){f.previewStory.finished?f.togglePlayMode(!1):(f.previewStory.changeTextScrollSpeed(e),-1!=f.previewStory.vnSelectedChoice&&5===e&&f.previewStory.vnSelectChoice())},this.togglePlayMode=function(e=!1){var t=n(".editor")[0],o=document.getElementById("storyPlayButton"),i=document.getElementById("editor-play");e?(f.togglePreviewMode(!1),t.style.display="none",i.style.display="flex",o.className="bbcode-button disabled",f.previewStory.emiter.on("finished",(function(){f.togglePlayMode(!1)})),f.previewStory.initYarn(JSON.parse(d.a.getSaveData(p.FILETYPE.JSON)),f.editing().title().trim(),"NVrichTextLabel",!1,"commandDebugLabel",f.playtestStyle)):(f.editor.session.setScrollTop(i.scrollTop),i.style.display="none",t.style.display="flex",o.className="bbcode-button",f.previewStory.terminate(),setTimeout(()=>{f.editing()&&f.editing().title()!==f.previewStory.node.title&&f.openNodeByTitle(f.previewStory.node.title),f.editor.focus()},1e3))},this.togglePreviewMode=function(e){const t=n(".editor")[0],o=n("#editor-preview")[0];f.isEditorInPreviewMode=e,e?(f.togglePlayMode(!1),t.style.display="none",o.style.display="block",o.innerHTML=f.richTextFormatter.richTextToHtml(f.editing().body(),!0),o.scrollTop=f.editor.renderer.scrollTop):(f.editor.session.setScrollTop(o.scrollTop),o.innerHTML="",o.style.display="none",t.style.display="flex",f.editor.focus(),f.editor.resize(),n("#colorPicker-container").is(":visible")&&n("#colorPicker-container").hide(),n("#emojiPicker-container").is(":visible")&&n("#emojiPicker-container").hide())},this.appendText=function(e){f.editing().body(f.editing().body()+e);var t=f.editor.session.getLength()-1,o=f.editor.session.getLine(t).length;f.editor.gotoLine(t+1,o)},this.moveEditCursor=function(e){var t=f.editor.getCursorPosition();f.editor.gotoLine(t.row+1,t.column+e),f.editor.focus()},this.insertTextAtCursor=function(e){f.editing()&&(f.editor.session.replace(f.editor.selection.getRange(),""),f.editor.session.insert(f.editor.getCursorPosition(),e),f.editor.focus())},this.getTagBeforeCursor=function(){const e=f.editor.getSelectionRange(),t=e.end.column,o=e.start.row,n=f.editor.session.getLine(o).substring(0,t);return n?f.richTextFormatter.identifyTag(n):""},this.saveNode=function(e=!0){const t=f.editing();if(t){const o=n("#editorTitle")[0];f.previewStory.terminate();const i=f.getFutureEditedNodeTitle();o.value=i,t.title(i),t.body(f.trimBodyLinks(t.body().trim())),f.makeNewNodesFromLinks(),f.propagateUpdateFromNode(t),f.workspace.updateArrows(),setTimeout(f.updateSearch,600),e&&(n(".node-editor").transition({opacity:0},250),n(".node-editor .form").transition({y:"-100"},250,(function(e){f.editing(null)}))),f.setYarnDocumentIsDirty()}},this.convertMarkup=function(){f.nodes().forEach(e=>{e.body(f.richTextFormatter.convert(e.body()))})},this.updateSearch=function(){for(var e=f.$searchField.val().toLowerCase(),t=n(".search-title input").is(":checked"),o=n(".search-body input").is(":checked"),i=n(".search-tags input").is(":checked"),s=0;s<f.nodes().length;s++){var r=f.nodes()[s],a=n(r.element);if(e.length>0&&(t||o||i)){var l=t&&r.title().toLowerCase().indexOf(e)>=0,c=o&&r.body().toLowerCase().indexOf(e)>=0,d=i&&r.tags().toLowerCase().indexOf(e)>=0;l||c||d?(r.active({title:l,body:c,tags:d}),a.clearQueue(),a.transition({opacity:1},500)):(r.active(!1),a.clearQueue(),a.transition({opacity:.25},500))}else r.active(!0),a.clearQueue(),a.transition({opacity:1},500)}},this.trimBodyLinks=function(e){return e.replace(/\[\[(.+?)\|\s*(.+?)\s*\]\]/g,"[[$1|$2]]")},this.updateNodeLinks=function(){for(let e of f.nodes())e.updateLinks()},this.propagateUpdateFromNode=function(e){var t=[],o=[];for(t.push(e);e=t.pop();)o.includes(e)||(o.push(e),e.updateLinks(),e.linkedTo().forEach(e=>{o.includes(e)||t.push(e)}),e.linkedFrom().forEach(e=>{o.includes(e)||t.push(e)}))},this.updateTagsRepository=function(){if(!f.mustUpdateTags)return;f.mustUpdateTags=!1;f.tags().forEach(e=>e.count=0),f.nodes().forEach(e=>{p.Utils.uniqueSplit(e.tags()," ").forEach(e=>{const t=f.tags().find(t=>t.text==e);if(t)++t.count;else{const t=(()=>{const e=f.tags().map(e=>e.id);for(let t=1;;++t)if(!e.includes(t))return t})();f.tags.push({id:t,style:"tag-style-"+t,text:e,count:1})}})});let e=f.tags().length;for(;e--;)0===f.tags()[e].count&&f.tags().splice(e,1)},this.makeNewNodesFromLinks=function(){if(!f.settings.createNodesEnabled())return console.info("Autocreate new nodes disabled");var e=f.editing().getLinksInNode();if(null!=e)for(var t=0;t<e.length;t++){const n=e[t].trim();var o=220*(t+1);f.makeNodeWithName(n,o)}},this.makeNodeWithName=function(e,t=220){const o=f.getOtherNodeTitles();e&&e.length>0&&!o.includes(e)&&e!=f.editing().title()&&f.newNodeAt(f.editing().x()+t,f.editing().y()-120).title(e)},this.titleExistsTwice=function(e){return f.nodes().filter(t=>t.title().trim()===e.trim()).length>1},this.getFutureEditedNodeTitle=function(){const e=n("#editorTitle")[0];return f.getUniqueTitle(e.value.trim())},this.getOtherNodeTitles=function(){var e=[];return f.nodes().forEach(t=>{f.editing()&&t.title()===f.editing().title()||e.push(t.title().trim())}),e},this.getHighlightedText=function(e){e=(e=(e=(e=(e=(e=(e=(e=e.replace(/\</g,"&lt;")).replace(/\>/g,"&gt;")).replace(/\&lt;\&lt;(.*?)\&gt;\&gt;/g,'<p class="conditionbounds">&lt;&lt;</p><p class="condition">$1</p><p class="conditionbounds">&gt;&gt;</p>')).replace(/\[\[([^\|]*?)\]\]/g,'<p class="linkbounds">[[</p><p class="linkname">$1</p><p class="linkbounds">]]</p>')).replace(/\[\[([^\[\]]*?)\|([^\[\]]*?)\]\]/g,'<p class="linkbounds">[[</p>$1<p style="color:red"><p class="linkbounds">|</p><p class="linkname">$2</p><p class="linkbounds">]]</p>')).replace(/[^:]\/\/(.*)?($|\n)/g,'<span class="comment">//$1</span>\n')).replace(/\/\*((.|[\r\n])*)?\*\//gm,'<span class="comment">/*$1*/</span>')).replace(/\/\%((.|[\r\n])*)?\%\//gm,'<span class="comment">/%$1%/</span>');var t=n("<div>");return t[0].innerHTML=e,t.find(".comment").each((function(){n(this).find("p").each((function(){n(this).removeClass()}))})),t.find(".linkname").each((function(){var e=n(this).text(),t=!1;for(var o in f.nodes())if(f.nodes()[o].title().toLowerCase()==e.toLowerCase()){t=!0;break}t||n(this).removeClass("linkname")})),e=t[0].innerHTML},this.updateLineNumbers=function(e){for(var t=e.split("\n"),o="",i=0;i<Math.max(1,t.length);i++)(0==i||i<t.length-1||t[i].length>0)&&(o+=i+1+"<br />");n(".editor-container .lines").html(o)},this.moveNodes=function(e,t){for(var o in f.nodes()){var n=f.nodes()[o];n.moveTo(n.x()+e,n.y()+t)}},this.getFirstFoundNode=function(e){return f.nodes().find(t=>t.title().toLowerCase().includes(e))},this.searchWarp=function(){var e=f.$searchField.val().toLowerCase().trim();if(""===e)f.workspace.warpToNodeByIdx(0);else{const t=f.getFirstFoundNode(e);f.workspace.warpToNodeByIdx(f.nodes.indexOf(t))}},this.clearSearch=function(){f.$searchField.val(""),f.updateSearch()},this.updateEditorStats=function(){var e=f.editor.getSession().getValue(),t=f.editor.getCursorPosition(),o=e.split("\n");n(".editor-counter .character-count").html(e.length),n(".editor-counter .line-count").html(o.length),n(".editor-counter .row-index").html(t.row),n(".editor-counter .column-index").html(t.column),d.a.saveAppStateToLocalStorage()},this.getUniqueTitle=function(e){var t=f.getOtherNodeTitles();if(e&&!t.includes(e))return e;var o=e||"Node",n=2;const i=o.match(/^(.*)(_([0-9]+))$/);if(i&&4===i.length&&(o=i[1],n=Number(i[3])),!t.includes(o))return o;for(;;++n){var s=o+"_"+n;if(!t.includes(s))return s}}}}).call(this,o("Z1dp"),o("EVdn"))},P3rc:function(e,t,o){"use strict";o.d(t,"a",(function(){return a}));const n=o("Wd8k"),i=o("L8pc"),s=new n.Runner,r=o("+qE3").EventEmitter;var a=function(){this.visitedNodes=[];this.node={title:""};let e=new r;this.emiter=e;let t=[];this.commandsPassedLog=t;this.commandPassed="";let o=!0;this.finished=o,this.scrollTextStyle=!1,this.visitedChapters=[],this.self=this,this.vnChoiceSelectionCursor=">",this.startTimeWait,this.vnSelectedChoice=-1,this.vnTextScrollInterval,this.storyChapter="",this.choices={};let n,a,l,c,d,u,p,g,h=null;this.vnSelectChoice=()=>{(new Date).getTime()-this.startTimeWait<1e3||(this.choices[this.storyChapter].push(c.options[this.vnSelectedChoice]),c.select(this.vnSelectedChoice),this.emiter.emit("choiceMade",c.options[this.vnSelectedChoice]),a="",n=void 0,c=self.goToNext(),this.vnSelectedChoice=-1,this.changeTextScrollSpeed(111))},this.vnUpdateChoice=(t=0)=>{if(this.vnSelectedChoice<0)return;let o=this.vnSelectedChoice+t;o>c.options.length-1?o=0:o<0&&(o=c.options.length-1),this.vnSelectedChoice=o,n=document.createElement("DIV"),c.options.forEach((e,t)=>{const o=document.createElement("DIV");t==this.vnSelectedChoice?o.innerHTML=`${this.vnChoiceSelectionCursor} [${e}]`:o.innerHTML=`${this.vnChoiceSelectionCursor.replace(/.*/gm,"&nbsp;")} [${e}]`,o.onclick=e=>{e.stopPropagation(),this.vnSelectedChoice=t,this.vnUpdateChoice()},o.ondblclick=e=>{e.stopPropagation(),this.vnSelectedChoice=t,this.vnSelectChoice()},o.className="storyPreviewChoiceButton",n.appendChild(o)}),e.emit("choiceUpdated",this.vnSelectedChoice),self.updateVNHud()},this.changeTextScrollSpeed=(t=0)=>{if(t!==this.vnTextScrollInterval){if(this.vnTextScrollInterval=t,clearInterval(u),h<0){if(this.isFinishedParsing(c))return void e.emit("finished");if("TextResult"===c.constructor.name)return a=c.text,h=0,e.emit("textResult",a),void this.changeTextScrollSpeed(220);"OptionsResult"===c.constructor.name&&-1===this.vnSelectedChoice&&(this.vnSelectedChoice=0,this.vnUpdateChoice(),this.startTimeWait=(new Date).getTime())}0!==t&&(u=setInterval(this.scrollUpdateText,t))}},self.goToNext=()=>{const e=d.next().value;if(!this.isFinishedParsing(e))return"TextResult"===e.constructor.name&&e.data&&this.node.title!==e.data.title&&(a="",h=-1,this.node=self.jsonCopy(e.data),this.visitedNodes.push(e.data.title),this.emiter.emit("startedNode",this.node)),e},this.isFinishedParsing=e=>(void 0===e||null===c)&&(o||(o=!0,h=-1),o=!0,o),this.runCommand=()=>{e.emit("commandCall",c.text),t.push(c.text),c=self.goToNext(),this.isFinishedParsing(c)||("TextResult"===c.constructor.name&&(a+="\n"+c.text,e.emit("textResult",c.text)),"OptionsResult"===c.constructor.name&&(h=-1))},this.scrollUpdateText=()=>{if(!this.isFinishedParsing(c))if(h<0)"CommandResult"===c.constructor.name&&this.runCommand();else if(h>a.length){if("TextResult"===c.constructor.name){if(c=self.goToNext(),this.isFinishedParsing(c))return;"CommandResult"===c.constructor.name?this.runCommand():("TextResult"===c.constructor.name||"OptionsResult"===c.constructor.name)&&(h=-1)}}else"TextResult"===c.constructor.name&&(h+=1,l=a.substring(0,h),self.updateVNHud())},self.updateVNHud=()=>{if("TextResult"===c.constructor.name){for(;l.lastIndexOf("[img]")>l.lastIndexOf("[/img]");)h+=1,l=a.substring(0,h);for(;l.lastIndexOf("[")>l.lastIndexOf("]");)h+=1,l=a.substring(0,h)}this.scrollTextStyle&&(document.getElementById(p).innerHTML=i.parse(l)+"<br>"),void 0!==n&&(this.scrollTextStyle||(document.getElementById(p).innerHTML=""),document.getElementById(p).appendChild(n))},this.terminate=()=>{try{let t=document.getElementById(p);t&&(t.innerHTML=""),t=document.getElementById(g),t&&(t.innerHTML=""),n=void 0,e.removeAllListeners(),this.finished=!0}catch(e){console.warn(e)}},this.initYarn=(t,n,r,a,l,c)=>{const d=["#f5ff6f","#44fe66","#e00ec0","#e93ecf","#0ec0e0","#3ecfe9","#e4dbcb","#978e7e","#666","#2f919a","deeppink","black","#97E1E9","#576574","#6EA5E0","#9EDE74","#FFE374","#F7A666","#C47862"],u=["__̴ı̴̴̡̡̡ ̡͌l̡̡̡ ̡͌l̡*̡̡ ̴̡ı̴̴̡ ̡̡͡| ̲▫̲͡ ̲̲͡▫̲̲͡͡ ̲|̡̡̡ ̡, ̴̡ı̴̡̡ ̡͌l̡̡̡̡.___","°º¤ø,¸¸,ø¤º°`°º¤ø,¸,ø¤°º¤ø,¸¸,ø¤º°`°º¤ø,¸","(===||:::::::::::::::>","¸.·´¯`·.´¯`·.¸¸.·´¯`·.¸><(((º>","=^..^=","|==|iiii|>-----"," ¦̵̱ ̵̱ ̵̱ ̵̱ ̵̱(̢ ̡͇̅└͇̅┘͇̅ (▤8כ−◦","(♥_♥)","龴ↀ◡ↀ龴","☁ ▅▒░☼‿☼░▒▅ ☁,","▓⚗_⚗▓","<:3 )~~~","(╯°□°）╯︵ ┻━┻","●▬▬▬▬๑۩۩๑▬▬▬▬▬●","(/)(Ö,,,,Ö)(/)","/)^3^(\\","( . Y . )","< )))) ><","(ノಠ益ಠ)ノ彡","d(^o^)b¸¸♬·¯·♩¸¸♪·¯·♫¸¸","O=('-'Q)","-`ღ´-","ˁ(⦿ᴥ⦿)ˀ","(╥﹏╥)","✲´*。.❄¨¯`*✲。❄。*。¨¯`*✲","▂▃▅▇█▓▒░۩۞۩        ۩۞۩░▒▓█▇▅▃▂","( •_•)O*¯`·.¸.·´¯`°Q(•_• )","┻━┻︵  (°□°)/ ︵ ┻━┻","|̲̲̲͡͡͡ ̲▫̲͡ ̲̲̲͡͡π̲̲͡͡ ̲̲͡▫̲̲͡͡ ̲|̡̡̡ ̡ ̴̡ı̴̡̡ ̡͌l̡ ̴̡ı̴̴̡ ̡l̡*̡̡ ̴̡ı̴̴̡ ̡̡͡|̲̲̲͡͡͡ ̲▫̲͡ ̲̲̲͡͡π̲̲͡͡ ̲̲͡▫̲̲͡͡ |","❤◦.¸¸.  ◦✿","ʕʘ̅͜ʘ̅ʔ","( ๏ Y ๏ )","ʕ•̫͡•ʕ*̫͡*ʕ•͓͡•ʔ-̫͡-ʕ•̫͡•ʔ*̫͡*ʔ-̫͡-ʔ","(っ◕‿◕)っ","❚█══█❚","─=≡Σ((( つ◕ل͜◕)つ","^ↀᴥↀ^","༼ つ ͡◕ Ѿ ͡◕ ༽つ","ᕦ(ò_óˇ)ᕤ","┬┴┬┴┤ ͜ʖ ͡°) ├┬┴┬┴","[̲̅$̲̅(̲̅5)̲̅$̲̅]","(ꈍ⌓ꈍ✿)","(๑•́ ₃ •̀๑) ♡","( • )( • )ԅ(≖⌣≖ԅ)","（。々°）","⊂(´･◡･⊂ )∘˚˳°","( ㅅ )","(ﾉ☉ヮ⚆)ﾉ ⌒*:･ﾟ✧","(－‸ლ)","(‿|‿)","(㇏(•̀ᵥᵥ•́)ノ)","ʚ✟⃛ɞ","(′ꈍωꈍ‵)","♚ ♛ ♜ ♝ ♞ ♟ ♔ ♕ ♖ ♗ ♘ ♙","(´ᴗ`)(´ᴗ`)","♥(´∀｀)","ฅ(˵●ﻌ●˵)ฅ"];g=l,p=r,this.yarnDataObject=t,this.startChapter=n,this.resourcesPath=a,this.finished=!1,this.scrollTextStyle="npc"===c,document.getElementById(g).innerHTML="<br/><font color='red'>🚥Press/Hold Z or 📱Double-click/Tap to advance</font><br/>",e.on("startedNode",(function(e){document.getElementById(g).innerHTML+="<br/><br/><font color='#581845'>📜 --- Loaded next node ---</font>",document.getElementById(g).innerHTML+=`<font color='${d[Math.floor(Math.random()*d.length)]}'>  ${u[Math.floor(Math.random()*u.length)]}</font>`,document.getElementById(g).innerHTML+="<br/><font color='CADETBLUE'>&ensp;&ensp;&ensp;Title: "+e.title+"</font>",e.tags.length>0&&e.tags[0].length>0&&(document.getElementById(g).innerHTML+="<br/><font color='deeppink'>&ensp;&ensp;&ensp;Tags: "+e.tags+"</font>")})),e.on("choiceMade",(function(e){this.scrollTextStyle?document.getElementById(g).innerHTML+="<br/><font color='fuchsia'>🐙Player chose: >"+e+"</font>":document.getElementById(g).innerHTML+=`<p class="story-playtest-bubble story-playtest-answer answer-post">${i.parse(e)}</p>`})),e.on("commandCall",(function(e){document.getElementById(g).innerHTML+=`<br/><font color='green'>🐣Command call:</font> <font color='red'>&lt;&lt;${e}&gt;&gt;</font>`})),this.scrollTextStyle||(e.on("textResult",(function(e){document.getElementById(g).innerHTML+=`<p class="story-playtest-bubble">${i.parse(e)}</p>`,document.getElementById(p).innerHTML='<span class="story-animated-dots"><p>.</p><p>.</p><p>.</p></span>',document.getElementById(p).className="story-playtest-bubble",document.getElementById(g).scrollTo({top:document.getElementById(g).scrollHeight,left:0,behavior:"smooth"})})),e.on("choiceUpdated",(function(e){document.getElementById(p).className="story-playtest-answer"}))),e.on("finished",(function(){o=!0,e.removeAllListeners()})),s.load(t),this.loadYarnChapter(n)},this.loadYarnChapter=e=>{o=!1,this.storyChapter=e,this.choices[this.storyChapter]=[],this.visitedChapters.push(e),d=s.run(e),c=self.goToNext(),a=c.text,this.changeTextScrollSpeed(100)},this.wasChoiceMade=(e,t=this.storyChapter)=>!!this.choices[t].includes(e),this.timesNodeWasVisited=e=>{let t=0;return this.visitedNodes.forEach((o,n)=>{o===e&&(t+=1)}),t},self.jsonCopy=e=>JSON.parse(JSON.stringify(e))}},Q0t6:function(e,t){function o(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}o.keys=function(){return[]},o.resolve=o,e.exports=o,o.id="Q0t6"},W2Rx:function(e,t,o){"use strict";(function(e,n){o.d(t,"a",(function(){return r}));var i=o("oj90");let s=0;let r=function(t={}){const o=this;this.titleStyles=["title-style-1","title-style-2","title-style-3","title-style-4","title-style-5","title-style-6","title-style-7","title-style-8","title-style-9"],this.index=e.observable(s++),this.title=e.observable(t.title||app.getUniqueTitle()),this.tags=e.observable(t.tags||""),this.body=e.observable(t.body||"Empty Text"),this.active=e.observable(t.active||!0),this.width=200,this.height=200,this.tempOpacity=null,this.style=null,this.colorID=e.observable(t.colorID||0),this.checked=!1,this.selected=!1,this.createX=t.x||null,this.createY=t.y||null,this.clippedTags=e.computed((function(){return app.updateTagsRepository(),i.Utils.uniqueSplit(o.tags()," ").map(e=>app.tags().find(t=>t.text===e)).filter(e=>e)}),this),this.clippedBody=e.computed((function(){if(app.editing())return;app.mustRefreshNodes();let e=app.getHighlightedText(this.body());return e=app.richTextFormatter.richTextToHtml(e),e=e.substr(0,1024),e}),this),this.linkedTo=e.observableArray(),this.linkedFrom=e.observableArray(),this.element=null,this.canDoubleClick=!0,this.create=function(){if(o.style=window.getComputedStyle(n(o.element).get(0)),o.createX&&o.createY)o.x(o.createX),o.y(o.createY);else{let e=n(o.element).parent();o.x(-e.offset().left+n(window).width()/2-100),o.y(-e.offset().top+n(window).height()/2-100)}app.workspace.bringToFront(o.element),app.workspace.startUpdatingArrows(),n(o.element).css({opacity:0,scale:.8,y:"-=80px",rotate:"45deg"}).transition({opacity:1,scale:1,y:"+=80px",rotate:"0deg"},250,"easeInQuad",(function(){app.workspace.stopUpdatingArrows(),app.workspace.updateArrows()})),o.drag(),n(o.element).on("dblclick",(function(){o.canDoubleClick&&app.editNode(o)})),i.Utils.addDoubleTapDetector(o.element,(function(){o.canDoubleClick&&app.editNode(o)})),n(o.element).on("click",(function(e){e.ctrlKey&&(o.selected?app.workspace.deselectNodes(o):app.workspace.selectNodes(o))}))},this.setSelected=function(e){o.selected=e,o.selected?n(o.element).addClass("selected"):n(o.element).removeClass("selected")},this.toggleSelected=function(){o.setSelected(!o.selected)},this.x=function(e){if(null!=e&&n(o.element).css({x:Math.floor(e)}),o.style)return Math.floor(new WebKitCSSMatrix(o.style.webkitTransform).m41)},this.y=function(e){if(null!=e&&n(o.element).css({y:Math.floor(e)}),o.style)return Math.floor(new WebKitCSSMatrix(o.style.webkitTransform).m42)},this.resetDoubleClick=function(){o.canDoubleClick=!0},this.cycleColorDown=function(){o.doCycleColorDown(),setTimeout(o.resetDoubleClick,500),o.canDoubleClick=!1,app.input.isShiftDown&&app.matchConnectedColorID(o),o.selected&&app.setSelectedColors(o),app.setYarnDocumentIsDirty()},this.cycleColorUp=function(){o.doCycleColorUp(),setTimeout(o.resetDoubleClick,500),o.canDoubleClick=!1,app.input.isShiftDown&&app.matchConnectedColorID(o),o.selected&&app.setSelectedColors(o),app.setYarnDocumentIsDirty()},this.doCycleColorDown=function(){o.colorID(o.colorID()-1),o.colorID()<0&&o.colorID(8)},this.doCycleColorUp=function(){o.colorID(o.colorID()+1),o.colorID()>8&&o.colorID(0)},this.remove=async function(){return new Promise((e,t)=>{n(o.element).transition({opacity:0,scale:.8,y:"-=80px",rotate:"-45deg"},250,"easeInQuad",e)})},this.drag=function(){const e={x:0,y:0};let t=!1,i=!1;n(document.body).on("mousemove touchmove",(function(n){if(t){const t=app.input.isScreenTouched&&n.changedTouches?n.changedTouches[0].pageX:n.pageX,s=app.input.isScreenTouched&&n.changedTouches?n.changedTouches[0].pageY:n.pageY;let{x:r,y:a}=app.workspace.toWorkspaceCoordinates(t,s);r-=e.x,a-=e.y;let l=r-o.x(),c=a-o.y();const d=app.workspace.getSelectedNodes();if(("mousemove"===n.originalEvent.type||d.includes(o)&&"touchmove"===n.originalEvent.type)&&(o.x(r),o.y(a)),i&&(o.selected?d.splice(d.indexOf(o),1):d=app.getNodesConnectedTo(o),d.length>0))for(let e in d)d[e].active()&&(d[e].x(d[e].x()+l),d[e].y(d[e].y()+c));app.workspace.updateArrows()}})),n(o.element).on("pointerdown",(function(n){if(!t&&o.active()&&0===n.button){t=!0,(app.input.isShiftDown||o.selected)&&(i=!0);const{x:s,y:r}=app.workspace.toWorkspaceCoordinates(n.pageX,n.pageY);e.x=s-o.x(),e.y=r-o.y()}})),n(o.element).on("pointerdown",(function(e){e.stopPropagation()})),n(o.element).on("touchend",(function(e){app.workspace.selectNodes(o)})),n(o.element).on("pointerup touchend",(function(e){t=!1,i=!1,app.setYarnDocumentIsDirty()}))},this.moveTo=function(e,t){app.workspace.startUpdatingArrows(),n(o.element).clearQueue(),n(o.element).transition({x:e,y:t},app.stopUpdatingArrows,500)},this.isConnectedTo=function(e,t){if(t&&e.isConnectedTo(o,!1))return!0;let n=o.linkedTo();for(let t in n){if(n[t]==e)return!0;if(n[t].isConnectedTo(e,!1))return!0;if(e.isConnectedTo(n[t],!1))return!0}return!1},this.getLinksInNode=function(e){let t=(e||o).body().match(/\[\[(.*?)\]\]/g);if(null!=t){let e={};for(let o=t.length-1;o>=0;o--)t[o]=t[o].substr(2,t[o].length-4).trim(),t[o].indexOf("|")>=0&&(t[o]=t[o].split("|")[1]),null!=e[t[o]]&&t.splice(o,1),e[t[o]]=!0;return t}},this.updateLinks=function(){o.resetDoubleClick(),o.updateLinksFromParents(),o.updateLinksToChildren()},this.updateLinksFromParents=function(){o.oldTitle&&o.oldTitle!==o.title()&&(o.linkedFrom.removeAll(),app.nodes().forEach(e=>{const t=o.getLinksInNode(e);if(t)if(t.includes(o.oldTitle)){const t=RegExp("\\|\\s*"+o.oldTitle+"\\s*\\]\\]","g"),n=e.body().replace(t,"|"+o.title()+"]]");e.body(n),o.linkedFrom.push(e)}else t.includes(o.title())&&o.linkedFrom.push(e)}),o.oldTitle=void 0)},this.updateLinksToChildren=function(){o.linkedTo.removeAll();let e=o.getLinksInNode();if(e)for(let t in app.nodes()){let n=app.nodes()[t];for(let t=0;t<e.length;t++)n!=o&&n.title().trim()===e[t].trim()&&o.linkedTo.push(n)}}};e.bindingHandlers.nodeBind={init:function(e,t,o,n,i){i.$rawData.element=e,i.$rawData.create()},update:function(e,t,o,i,s){n(e).on("pointerdown",(function(){app.workspace.bringToFront(e)}))}}}).call(this,o("Z1dp"),o("EVdn"))},e6Wu:function(e,t,o){"use strict";o.r(t);o("hZTp");var n=o("oj90"),i=o("0h2I"),s=o.n(i),r=(o("5uVa"),o("si6p"),o("bU/s")),a=o.n(r),l=(o("A8C4"),o("VEX6"),o("jF1P"),o("YhK8"),o("Ab/9"),o("KDOe"),o("XfCI"),o("PSD3")),c=o.n(l),d=o("P0sH"),u=o("pLxK");window.ko=s.a,window.$=window.jQuery=o("EVdn"),window.ace=a.a,a.a.config.set("basePath",n.Utils.getPublicPath()),window.define=a.a.define,window.Swal=c.a,"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("sw.js").then(e=>{console.log("SW registered: ",e)}).catch(e=>{console.log("SW registration failed: ",e)})}),window.app=new d.a("Yarn",u.a),window.app.run()},fkuv:function(e,t,o){"use strict";(function(e,n){o.d(t,"a",(function(){return i}));const i=function(t){const o=this;this.settingsDialogVisible=e.observable(!1),this.availableMarkupLanguages=[{id:"bbcode",name:"Bbcode"},{id:"html",name:"Html"}],this.availableThemes=[{id:"classic",name:"Classic"},{id:"blueprint",name:"Blueprint"}],this.availablePlaytestStyles=[{id:"npc",name:"Npc bubble"},{id:"chat",name:"Chat messages"}],this.availableLanguages=[{name:"Afrikaans",id:"af-ZA"},{name:"Bahasa Indonesia",id:"id-ID"},{name:"Bahasa Melayu",id:"ms-MY"},{name:"Català",id:"ca-ES"},{name:"Čeština",id:"cs-CZ"},{name:"Deutsch",id:"de-DE"},{name:"English",id:"en-GB"},{name:"Español",id:"es-ES"},{name:"Euskara",id:"eu-ES"},{name:"Français",id:"fr-FR"},{name:"Galego",id:"gl-ES"},{name:"Hrvatski",id:"hr_HR"},{name:"IsiZulu",id:"zu-ZA"},{name:"Íslenska",id:"is-IS"},{name:"Italiano",id:"it-IT"},{name:"Magyar",id:"hu-HU"},{name:"Nederlands",id:"nl-NL"},{name:"Norsk bokmål",id:"nb-NO"},{name:"Polski",id:"pl-PL"},{name:"Português",id:"pt-BR"},{name:"Română",id:"ro-RO"},{name:"Slovenčina",id:"sk-SK"},{name:"Suomi",id:"fi-FI"},{name:"Svenska",id:"sv-SE"},{name:"Türkçe",id:"tr-TR"},{name:"български",id:"bg-BG"},{name:"Pусский",id:"ru-RU"},{name:"Српски",id:"sr-RS"},{name:"한국어",id:"ko-KR"},{name:"中文",id:"cmn-Hans-CN"},{name:"日本語",id:"ja-JP"},{name:"Lingua latīna",id:"la"}],this.openSettingsDialog=function(){o.settingsDialogVisible(!0),n(".settings-dialog").css({opacity:0}).transition({opacity:1},250),n(".settings-dialog .form").css({y:"-100"}).transition({y:"0"},250)},this.closeSettingsDialog=function(){n(".settings-dialog").css({opacity:1}).transition({opacity:0},250,e=>{o.settingsDialogVisible(!1)}),n(".settings-dialog .form").css({y:"0"}).transition({y:"-100"},250),setTimeout(()=>t.settings.apply(),100)},this.isDialogOpen=function(){return o.settingsDialogVisible()||n(".swal2-popup").length>0},this.confirmMarkupConversion=function(){Swal.fire({title:"Are you sure?",text:"Markup on all nodes will be modified. This can rarely result in broken texts. This operation can't be undone.",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, convert it!",cancelButtonText:"No, cancel!",reverseButtons:!0}).then(e=>{e.value&&(t.convertMarkup(),Swal.fire("Converted!","The markup on the nodes has been converted.","success"))})},this.openNodeListMenu=function(e){const o="link"===e?document.getElementById("linkHelperMenuFilter").value.toLowerCase():document.getElementById("nodeSearchInput").value.toLowerCase(),i=document.getElementById(e+"HelperMenu");i.innerHTML="",t.nodes().forEach((s,r)=>{if(s.title().toLowerCase().indexOf(o)>=0||0==o.length){const a=document.createElement("span");a.innerHTML=s.title(),n(a).addClass("item "+t.nodes()[r].titleStyles[t.nodes()[r].colorID()]),"link"==e?s.title()!==t.editing().title()&&(a.setAttribute("onclick","app.insertTextAtCursor(' [[Answer:"+s.title()+"|"+s.title()+"]]')"),i.appendChild(a)):"open"==e&&(s.title().toLowerCase().indexOf(o)>=0||0==o.length)&&(a.setAttribute("onclick",`app.openNodeByTitle("${s.title()}")`),a.setAttribute("onmouseenter",`app.workspace.warpToNodeByIdx(${t.nodes.indexOf(s)})`),i.appendChild(a))}})}}}).call(this,o("Z1dp"),o("EVdn"))},hZTp:function(e,t,o){},jF1P:function(e,t,o){(function(e){var t,o;t={},o=0,e.bindingHandlers.ace={init:function(n,i,s,r,a){var l=s().aceOptions||{},c=e.utils.unwrapObservable(i());n.id||(n.id="knockout-ace-"+o,o+=1);var d=ace.edit(n.id);l.theme&&d.setTheme("ace/theme/"+l.theme),l.mode&&d.getSession().setMode("ace/mode/"+l.mode),d.setValue(c),d.gotoLine(0),d.setShowPrintMargin(!1),d.getSession().setUseWrapMode(!0),d.getSession().on("change",(function(t){e.isWriteableObservable(i())&&i()(d.getValue())})),t[n.id]=d,e.utils.domNodeDisposal.addDisposeCallback(n,(function(){try{d.destroy()}catch(e){}delete t[n.id]}))},update:function(o,n,i,s,r){var a=e.utils.unwrapObservable(n()),l=o.id;if(void 0!==l&&""!==l&&t.hasOwnProperty(l)){var c=t[l];c.getValue()!==a&&(c.setValue(a),c.gotoLine(0))}}},e.aceEditors={resizeAll:function(){for(var e in t)t.hasOwnProperty(e)&&t[e].resize()},get:function(e){return t[e]}}}).call(this,o("Z1dp"))},"l8+o":function(e,t,o){"use strict";o.d(t,"a",(function(){return s}));var n=o("mIo7"),i=o("mqgS");const s=function(e){return"html"===e.settings.markupLanguage()?new i.a(e):new n.a(e)}},mIo7:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return BbcodeRichTextFormatter}));const bbcode=__webpack_require__("L8pc"),BbcodeRichTextFormatter=function(app){const self=this;this.completableTags=Object.freeze([{Start:"[[",Completion:" answer: | ]] ",Offset:-4},{Start:"<<",Completion:" >> ",Offset:-3},{Start:"[colo",Completion:"r=#][/color] ",Offset:-10,Func:()=>{app.insertColorCode()}},{Start:"[b",Completion:"][/b] ",Offset:-5},{Start:"[i",Completion:"][/i] ",Offset:-5},{Start:"[img",Completion:"][/img] ",Offset:-7},{Start:"[u",Completion:"][/u] ",Offset:-5},{Start:"[url",Completion:"][/url] ",Offset:-7}]),this.getTagOpen=function(e){switch(e){case"cmd":return"<<";case"opt":return"[[";case"color":return"[color=#]";default:return`[${e}]`}},this.getTagClose=function(e){switch(e){case"cmd":return">>";case"opt":return"|]]";default:return`[/${e}]`}},this.identifyTag=function(e){let t=-1!==e.lastIndexOf("[")?e.substring(e.lastIndexOf("["),e.length):"";return"[["===e.substring(e.length-2,e.length)?t="[[":"<<"===e.substring(e.length-2,e.length)&&(t="<<"),t},this.insertTag=function(e){const t=self.getTagOpen(e),o=self.getTagClose(e),n=JSON.parse(JSON.stringify(app.editor.selection.getRange()));app.editor.session.insert(n.start,t),app.editor.session.insert({column:n.end.column+t.length,row:n.end.row},o),"color"===e&&(0===app.editor.getSelectedText().length?app.moveEditCursor(-9):app.editor.selection.setRange({start:{row:app.editor.selection.getRange().start.row,column:app.editor.selection.getRange().start.column-1},end:{row:app.editor.selection.getRange().start.row,column:app.editor.selection.getRange().start.column-1}}),app.insertColorCode()),"img"===e?0===app.editor.getSelectedText().length&&(app.moveEditCursor(-6),app.data.triggerPasteClipboard(),setTimeout(()=>app.moveEditCursor(6),300)):0===app.editor.getSelectedText().length?app.isEditorInPreviewMode||app.moveEditCursor(-o.length):app.editor.selection.setRange({start:app.editor.selection.getRange().start,end:{row:app.editor.selection.getRange().end.row,column:app.editor.selection.getRange().end.column-o.length}}),app.editor.focus()},this._convertTag=function(inPattern,outPattern,text){const globalRegex=new RegExp(inPattern,"gi"),localRegex=new RegExp(inPattern,"i");return text.replace(globalRegex,m=>{const match=m.match(localRegex),template=eval("`"+outPattern+"`");return match.length?template:null})},this.convert=function(e){let t=e;return t=self._convertTag("<b>(.*?)<\\/b>","[b]${match[1]}[/b]",t),t=self._convertTag("<u>(.*?)<\\/u>","[u]${match[1]}[/u]",t),t=self._convertTag("<i>(.*?)<\\/i>","[i]${match[1]}[/i]",t),t=self._convertTag("<img>(.*?)<\\/img>","[img]${match[1]}[/img]",t),t=self._convertTag("<color=#(.*?)>(.*?)<\\/color>","[color=#${match[1]}]${match[2]}[/color]",t),t=self._convertTag("<url>(.*?)<\\/url>","[url]${match[1]}[/url]",t),t},this.richTextToHtml=function(e,t=!1){let o=1,n=t?'<div><font color="pink">'+o+". </font><font>"+e+"</font></div>":e;if(n=n.replace(/<</gi,"<font color='violet'>(run:"),n=n.replace(/>>/gi,")</font>"),n=n.replace(/\[color=#[A-Za-z0-9]+\]/gi,(function(e){const t=e.match(/\[color=#([A-Za-z0-9]+)\]/i);if(t&&t.length>1)return"[color=#"+t[1]+"]<font color=#"+t[1]+">&#9751</font>"})),n=n.replace(/\[img\][^\[]+\[\/img\]/gi,(function(e){const o=e.match(/\[img\](.*)\[\/img\]/i);if(o.length>1){const e=app.data.editingFileFolder(o[1]);return app.data.doesFileExist(e)?t?'<img src="'+e+'"> </img>':'<img src="'+e+'" width="128" height="auto"> </img>':t?'<img src="'+o[1]+'"> </img>':'<img src="'+o[1]+'" width="128" height="auto"> </img>'}})),n=n.replace(/[\n\r]/g,(function(e){let n="</font><br/>";return o+=1,t&&(n+='</div><div><font color="pink">'+o+". </font><font>"),n})),n=bbcode.parse(n),t){const e=[];n=n.replace(/(https?:\/\/twitter.com\/[^\s\<]+\/[^\s\<]+\/[^\s\<]+)/gi,(function(t){const o=t.match(/https:\/\/twitter.com\/.*\/status\/([0-9]+)/i);if(o.length>1)return e.push(o[1]),`<a class="tweet" id="${o[1]}"></a>`})),setTimeout(()=>{const t=document.querySelectorAll(".tweet");e.forEach((e,o)=>{twttr.widgets.createTweet(e,t[o],{align:"center",follow:!1})})},500)}return n}}},mqgS:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return HtmlRichTextFormatter}));const HtmlRichTextFormatter=function(app){const self=this;this.completableTags=Object.freeze([{Start:"[[",Completion:" answer: | ]] ",Offset:-4},{Start:"<<",Completion:" >> ",Offset:-3},{Start:"<colo",Completion:"r=#></color> ",Offset:-10,Func:()=>{app.insertColorCode()}},{Start:"<b",Completion:"></b> ",Offset:-5},{Start:"<img",Completion:"></img> ",Offset:-7},{Start:"<i",Completion:"></i> ",Offset:-5},{Start:"<u",Completion:"></u> ",Offset:-5},{Start:"<url",Completion:"></url> ",Offset:-7}]),this.getTagOpen=function(e){switch(e){case"cmd":return"<<";case"opt":return"[[";case"color":return"<color=#>";default:return`<${e}>`}},this.getTagClose=function(e){switch(e){case"cmd":return">>";case"opt":return"|]]";default:return`</${e}>`}},this.identifyTag=function(e){let t=-1!==e.lastIndexOf("<")?e.substring(e.lastIndexOf("<"),e.length):"";return"[["===e.substring(e.length-2,e.length)?t="[[":"<<"===e.substring(e.length-2,e.length)&&(t="<<"),t},this.insertTag=function(e){const t=self.getTagOpen(e),o=self.getTagClose(e),n=JSON.parse(JSON.stringify(app.editor.selection.getRange()));app.editor.session.insert(n.start,t),app.editor.session.insert({column:n.end.column+t.length,row:n.end.row},o),"color"===e&&(0===app.editor.getSelectedText().length?app.moveEditCursor(-9):app.editor.selection.setRange({start:{row:app.editor.selection.getRange().start.row,column:app.editor.selection.getRange().start.column-1},end:{row:app.editor.selection.getRange().start.row,column:app.editor.selection.getRange().start.column-1}}),app.insertColorCode()),"img"===e?navigator.clipboard.readText().then(e=>{0===app.editor.getSelectedText().length&&(app.moveEditCursor(-7),app.insertTextAtCursor(` src="${e}"`))}):0===app.editor.getSelectedText().length?app.isEditorInPreviewMode||app.moveEditCursor(-o.length):app.editor.selection.setRange({start:app.editor.selection.getRange().start,end:{row:app.editor.selection.getRange().end.row,column:app.editor.selection.getRange().end.column-o.length}}),app.editor.focus()},this._convertTag=function(inPattern,outPattern,text){const globalRegex=new RegExp(inPattern,"gi"),localRegex=new RegExp(inPattern,"i");return text.replace(globalRegex,m=>{const match=m.match(localRegex),template=eval("`"+outPattern+"`");return match.length?template:null})},this.convert=function(e){let t=e;return t=self._convertTag("\\[b\\](.*?)\\[\\/b\\]","<b>${match[1]}</b>",t),t=self._convertTag("\\[u\\](.*?)\\[\\/u\\]","<u>${match[1]}</u>",t),t=self._convertTag("\\[i\\](.*?)\\[\\/i\\]","<i>${match[1]}</i>",t),t=self._convertTag("\\[img\\](.*?)\\[\\/img\\]","<img>${match[1]}</img>",t),t=self._convertTag("\\[color=#(.*?)\\](.*?)\\[\\/color\\]","<color=#${match[1]}>${match[2]}</color>",t),t=self._convertTag("\\[url\\](.*?)\\[\\/url\\]","<url>${match[1]}</url>",t),t},this.richTextToHtml=function(e,t=!1){let o=1,n=t?'<div><font color="pink">'+o+". </font><font>"+e+"</font></div>":e;if(n=n.replace(/<</gi,"<font color='violet'>(run:"),n=n.replace(/>>/gi,")</font>"),[/&lt;color=#(.*?)&gt;(.*?)&lt;\/color&gt;/,/<color=#(.*?)>(.*?)<\/color>/].forEach(e=>{const t=new RegExp(e,"gi"),o=new RegExp(e,"i");n=n.replace(t,(function(e){const t=e.match(o);if(t&&t.length>2)return`<font color=#${t[1]}>&#9751${t[2]}</font>`}))}),n=n.replace(/&lt;img&gt;[^\[]+&lt;\/img&gt;/gi,(function(e){const o=e.match(/&lt;img&gt;(.*?)&lt;\/img&gt;/i);if(o.length>1){const e=app.data.editingFileFolder(o[1]);return app.data.doesFileExist(e)?t?'<img src="'+e+'"> </img>':'<img src="'+e+'" width="128" height="auto"> </img>':t?'<img src="'+o[1]+'"> </img>':'<img src="'+o[1]+'" width="128" height="auto"> </img>'}})),n=n.replace(/&lt;b&gt;.*&lt;\/b&gt;/gi,e=>{const t=e.match(/&lt;b&gt;(.*)&lt;\/b&gt;/i);if(t.length)return`<b>${t[1]}</b>`}),n=n.replace(/&lt;u&gt;.*&lt;\/u&gt;/gi,e=>{const t=e.match(/&lt;u&gt;(.*)&lt;\/u&gt;/i);if(t.length)return`<u>${t[1]}</u>`}),n=n.replace(/&lt;i&gt;.*&lt;\/i&gt;/gi,e=>{const t=e.match(/&lt;i&gt;(.*)&lt;\/i&gt;/i);if(t.length)return`<i>${t[1]}</i>`}),n=n.replace(/[\n\r]/g,(function(e){let n="</font><br/>";return o+=1,t&&(n+='</div><div><font color="pink">'+o+". </font><font>"),n})),t){const e=[];n=n.replace(/(https?:\/\/twitter.com\/[^\s\<]+\/[^\s\<]+\/[^\s\<]+)/gi,(function(t){const o=t.match(/https:\/\/twitter.com\/.*\/status\/([0-9]+)/i);if(o.length>1)return e.push(o[1]),`<a class="tweet" id="${o[1]}"></a>`})),setTimeout(()=>{const t=document.querySelectorAll(".tweet");e.forEach((e,o)=>{twttr.widgets.createTweet(e,t[o],{align:"center",follow:!1})})},500)}return n}}},oj90:function(e,t,o){"use strict";o.r(t),function(e){o.d(t,"FILETYPE",(function(){return n})),o.d(t,"Utils",(function(){return i}));var n={JSON:"json",XML:"xml",TWEE:"twee",TWEE2:"tw2",UNKNOWN:"none",YARN:"yarn"},i={createAutocompleter:function(e,t,o,n=1){return{getCompletions:function(i,s,r,a,l){var c=i.session.getTokenAt(r.row,r.column);a.length<n||!e.includes(c.type)?l(null,[]):l(null,t.map((function(e){return{caption:e,value:e,meta:o}})))}}},addDoubleTapDetector:function(e,t){e.lastTap=0,e.tapTimeout=0,e.addEventListener("touchend",(function(o){var n=(new Date).getTime(),i=n-e.lastTap;clearTimeout(e.tapTimeout),i<500&&i>0?(t(),o.preventDefault()):e.tapTimeout=setTimeout((function(){clearTimeout(e.tapTimeout)}),500),e.lastTap=n}))},uniqueSplit:function(e,t=" "){return[...new Set(e.split(t).filter(e=>e))]},getHighestZ:function(t){let o=Number.NEGATIVE_INFINITY;return e(t).children().each((function(){let t=parseInt(e(this).css("z-index"))||0;t>o&&(o=t)})),o},clamp:function(e,t,o){return Math.max(Math.min(e,o),t)},rectanglesOverlap:function(e,t){return!(t.left>e.right||t.right<e.left||t.top>e.bottom||t.bottom<e.top)},stripHtml:function(e){for(;e.indexOf("<")>=0;)e=e.replace("<","&lt;");for(;e.indexOf(">")>=0;)e=e.replace(">","&gt");return e},xmlToObject:function(e){var t=[];if((e=e.childNodes.item(0)).hasChildNodes())for(var o=0;o<e.childNodes.length;o++){var n=e.childNodes.item(o);if(n.hasChildNodes()){for(var i={},s=!1,r=0;r<n.childNodes.length;r++){var a=n.childNodes.item(r);if("#text"!=a.nodeName&&(s=!0,a.hasChildNodes()?i[a.nodeName]=a.childNodes.item(0).nodeValue:i[a.nodeName]="",a.attributes.length>0)){i[a.nodeName]={};for(var l=0;l<a.attributes.length;l++){var c=a.attributes.item(l);i[a.nodeName][c.nodeName]=c.nodeValue}}}s&&t.push(i)}}return t},now:Date.now||function(){return(new Date).getTime()},getPublicPath:function(e){return window.getPublicVsCodeWebviewUri?window.getPublicVsCodeWebviewUri(e):"public"+(e?"/"+e:"")}}}.call(this,o("EVdn"))},owJe:function(e,t,o){(function(e){var n=o("jXEy"),i=o("oj90"),s=i.Utils.getPublicPath("dictionaries/en/index.dic"),r=i.Utils.getPublicPath("dictionaries/en/index.aff");e("<style type='text/css'>.ace_marker-layer .misspelled { position: absolute; z-index: -2; border-bottom: 1px solid red; margin-bottom: -1px; }</style>").appendTo("head"),e("<style type='text/css'>.misspelled { border-bottom: 1px solid red; margin-bottom: -1px; }</style>").appendTo("head");var a=null;function l(e){var t=e.split(/\s+|\.|\,|\?|\\|\/|\!|\[|\]|"|'|;|:|`|\+|\-|\&|\$|@|~|#|>|<|_|\)|\(|£|\^|%|\*|„|“|\||[0-9]+/g),o=0,n=[];for(word in t){var i=t[word];a.correct(i)||(n[n.length]=[o,o+t[word].length]),o+=t[word].length+1}return n}t.load_dictionary=function(t){console.info(`Loading ${t} hunspell dictionary locally`),s=i.Utils.getPublicPath(`dictionaries/${t}/index.dic`),r=i.Utils.getPublicPath(`dictionaries/${t}/index.aff`),e.get(s,(function(e){dicData=e})).fail((function(){console.error(t+" not found locally. Loading dictionary from server instead..."),s=`https://raw.githubusercontent.com/wooorm/dictionaries/master/dictionaries/${t}/index.dic`,r=`https://raw.githubusercontent.com/wooorm/dictionaries/master/dictionaries/${t}/index.aff`,e.get(s,(function(e){dicData=e})).done((function(){e.get(r,(function(e){affData=e})).done((function(){console.log("Dictionary loaded from server"),a=new n(affData,dicData),c=!0}))}))})).done((function(){e.get(r,(function(e){affData=e})).done((function(){console.log("Dictionary loaded locally"),a=new n(affData,dicData),c=!0}))}))},t.misspelled=l;var c=!0,d=!1,u=[];function p(){if(null!=a&&!d&&c){d=!0;var e=ace.edit("editor").getSession();h();try{var t=ace.require("ace/range").Range,o=e.getDocument().getAllLines();for(var n in o){var i=l(o[n]);for(var s in i){var r=new t(n,i[s][0],n,i[s][1]);u[u.length]=e.addMarker(r,"misspelled","typo",!0)}}}finally{d=!1,c=!1}}}t.spell_check=p;var g=!1;function h(){var e=ace.edit("editor").getSession();for(var t in u)e.removeMarker(u[t]);u=[];var o=e.getDocument().getAllLines();for(var t in o)e.removeGutterDecoration(t,"misspelled")}t.enable_spellcheck=function(){g=!0,ace.edit("editor").getSession().on("change",(function(e){g&&(c=!0,p())})),c=!0,p()},t.disable_spellcheck=function(){g=!1,h()},t.clear_spellcheck_markers=h,t.suggest_word_for_misspelled=function(e){var t=a.suggest(e);return 0!==t.length&&t}}).call(this,o("EVdn"))},pLxK:function(e){e.exports=JSON.parse('{"a":"0.4.106"}')},pYPP:function(e,t,o){"use strict";(function(e){o.d(t,"a",(function(){return n}));const n=function(t){const o=this,n=window.vsCodeApi?{getItem:()=>{},setItem:()=>{}}:window.localStorage;this.storage=n,e.extenders.persist=function(e,t){return e.subscribe((function(e){n.setItem(t,e)})),e},this.apply=function(){t.setTheme(o.theme()),t.setLanguage(o.language()),t.toggleNightMode(),t.setMarkupLanguage(o.markupLanguage()),t.workspace.setThrottle(o.redrawThrottle()),t.setGistCredentials({token:o.gistToken(),file:null!==o.gistFile()?o.gistFile().split("/").pop():null})},this.theme=e.observable(n.getItem("theme")||"classic").extend({persist:"theme"}),this.language=e.observable(n.getItem("language")||"en-GB").extend({persist:"language"}),this.redrawThrottle=e.observable(parseInt(n.getItem("redrawThrottle")||"50")).extend({persist:"redrawThrottle"}),this.gistToken=e.observable(n.getItem("gistToken")).extend({persist:"gistToken"}),this.gistFile=e.observable(n.getItem("gistFile")).extend({persist:"gistFile"}),this.spellcheckEnabled=e.observable(null===n.getItem("spellcheckEnabled")||"true"===n.getItem("spellcheckEnabled")).extend({persist:"spellcheckEnabled"}),this.transcribeEnabled=e.observable(!1),this.completeTagsEnabled=e.observable(null===n.getItem("completeTagsEnabled")||"true"===n.getItem("completeTagsEnabled")).extend({persist:"completeTagsEnabled"}),this.completeWordsEnabled=e.observable(null===n.getItem("completeWordsEnabled")||"true"===n.getItem("completeWordsEnabled")).extend({persist:"completeWordsEnabled"}),this.completeClosingCharacters=e.observable(null===n.getItem("completeClosingCharacters")||"true"===n.getItem("completeClosingCharacters")).extend({persist:"completeClosingCharacters"}),this.nightModeEnabled=e.observable(null!==n.getItem("nightModeEnabled")&&"true"===n.getItem("nightModeEnabled")).extend({persist:"nightModeEnabled"}),this.createNodesEnabled=e.observable(null===n.getItem("createNodesEnabled")||"true"===n.getItem("createNodesEnabled")).extend({persist:"createNodesEnabled"}),this.editorStatsEnabled=e.observable(null!==n.getItem("editorStatsEnabled")&&"true"===n.getItem("editorStatsEnabled")).extend({persist:"editorStatsEnabled"}),this.markupLanguage=e.observable(n.getItem("markupLanguage")||"bbcode").extend({persist:"markupLanguage"}),this.playtestStyle=e.observable(n.getItem("playtestStyle")||"chat").extend({persist:"playtestStyle"}),this.alwaysOpenNodesInVisualStudioCodeEditor=e.observable(null!==n.getItem("alwaysOpenNodesInVisualStudioCodeEditor")&&"true"===n.getItem("alwaysOpenNodesInVisualStudioCodeEditor")).extend({persist:"alwaysOpenNodesInVisualStudioCodeEditor"})}}).call(this,o("Z1dp"))}},[["e6Wu",1,2]]]);